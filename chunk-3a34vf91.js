(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a34vf91"],{"0335":function(e,t,n){n("0f58")},"080b":function(e,t){(function(){(function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.Env"),n=function(e){return e.getParam("pagebreak_separator","\x3c!-- pagebreak --\x3e")},r=function(e){return e.getParam("pagebreak_split_block",!1)},o={getSeparatorHtml:n,shouldSplitBlock:r},i=function(){return"mce-pagebreak"},a=function(){return'<img src="'+t.transparentSrc+'" class="'+i()+'" data-mce-resize="false" data-mce-placeholder />'},c=function(e){var t=o.getSeparatorHtml(e),n=new RegExp(t.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(e){return"\\"+e}),"gi");e.on("BeforeSetContent",function(e){e.content=e.content.replace(n,a())}),e.on("PreInit",function(){e.serializer.addNodeFilter("img",function(n){var r,i,a=n.length;while(a--)if(r=n[a],i=r.attr("class"),i&&-1!==i.indexOf("mce-pagebreak")){var c=r.parent;if(e.schema.getBlockElements()[c.name]&&o.shouldSplitBlock(e)){c.type=3,c.value=t,c.raw=!0,r.remove();continue}r.type=3,r.value=t,r.raw=!0}})})},u={setup:c,getPlaceholderHtml:a,getPageBreakClass:i},l=function(e){e.addCommand("mcePageBreak",function(){e.settings.pagebreak_split_block?e.insertContent("<p>"+u.getPlaceholderHtml()+"</p>"):e.insertContent(u.getPlaceholderHtml())})},s={register:l},f=function(e){e.on("ResolveName",function(t){"IMG"===t.target.nodeName&&e.dom.hasClass(t.target,u.getPageBreakClass())&&(t.name="pagebreak")})},d={setup:f},m=function(e){e.addButton("pagebreak",{title:"Page break",cmd:"mcePageBreak"}),e.addMenuItem("pagebreak",{text:"Page break",icon:"pagebreak",cmd:"mcePageBreak",context:"insert"})},g={register:m};function p(){}e.add("pagebreak",function(e){s.register(e),g.register(e),u.setup(e),d.setup(e)})})()})()},"0a9d":function(e,t,n){n("69a4")},"0aa0":function(e,t,n){n("3b47")},"0efa":function(e,t,n){n("4bdc")},"0f58":function(e,t){(function(){(function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager");function t(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.concat(n);return e.apply(null,o)}}var n=tinymce.util.Tools.resolve("tinymce.util.Tools"),r=tinymce.util.Tools.resolve("tinymce.util.XHR"),o=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),i=function(e){return e.getParam("template_cdate_classes","cdate")},a=function(e){return e.getParam("template_mdate_classes","mdate")},c=function(e){return e.getParam("template_selected_content_classes","selcontent")},u=function(e){return e.getParam("template_preview_replace_values")},l=function(e){return e.getParam("template_replace_values")},s=function(e){return e.templates},f=function(e){return e.getParam("template_cdate_format",e.getLang("template.cdate_format"))},d=function(e){return e.getParam("template_mdate_format",e.getLang("template.mdate_format"))},m=function(e){return e.getParam("template_popup_width",600)},g=function(e){return Math.min(o.DOM.getViewPort().h,e.getParam("template_popup_height",500))},p={getCreationDateClasses:i,getModificationDateClasses:a,getSelectedContentClasses:c,getPreviewReplaceValues:u,getTemplateReplaceValues:l,getTemplates:s,getCdateFormat:f,getMdateFormat:d,getDialogWidth:m,getDialogHeight:g},h=function(e,t){if(e=""+e,e.length<t)for(var n=0;n<t-e.length;n++)e="0"+e;return e},v=function(e,t,n){var r="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),o="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),i="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),a="January February March April May June July August September October November December".split(" ");return n=n||new Date,t=t.replace("%D","%m/%d/%Y"),t=t.replace("%r","%I:%M:%S %p"),t=t.replace("%Y",""+n.getFullYear()),t=t.replace("%y",""+n.getYear()),t=t.replace("%m",h(n.getMonth()+1,2)),t=t.replace("%d",h(n.getDate(),2)),t=t.replace("%H",""+h(n.getHours(),2)),t=t.replace("%M",""+h(n.getMinutes(),2)),t=t.replace("%S",""+h(n.getSeconds(),2)),t=t.replace("%I",""+((n.getHours()+11)%12+1)),t=t.replace("%p",n.getHours()<12?"AM":"PM"),t=t.replace("%B",""+e.translate(a[n.getMonth()])),t=t.replace("%b",""+e.translate(i[n.getMonth()])),t=t.replace("%A",""+e.translate(o[n.getDay()])),t=t.replace("%a",""+e.translate(r[n.getDay()])),t=t.replace("%%","%"),t},y={getDateTime:v},b=function(e,t){return function(){var n=p.getTemplates(e);"function"!==typeof n?"string"===typeof n?r.send({url:n,success:function(e){t(JSON.parse(e))}}):t(n):n(t)}},w=function(e,t,r){return n.each(r,function(e,n){"function"===typeof e&&(e=e(n)),t=t.replace(new RegExp("\\{\\$"+n+"\\}","g"),e)}),t},x=function(e,t){var r=e.dom,o=p.getTemplateReplaceValues(e);n.each(r.select("*",t),function(e){n.each(o,function(t,n){r.hasClass(e,n)&&"function"===typeof o[n]&&o[n](e)})})},T=function(e,t){return new RegExp("\\b"+t+"\\b","g").test(e.className)},k=function(e,t,r){var o,i,a=e.dom,c=e.selection.getContent();r=w(e,r,p.getTemplateReplaceValues(e)),o=a.create("div",null,r),i=a.select(".mceTmpl",o),i&&i.length>0&&(o=a.create("div",null),o.appendChild(i[0].cloneNode(!0))),n.each(a.select("*",o),function(t){T(t,p.getCreationDateClasses(e).replace(/\s+/g,"|"))&&(t.innerHTML=y.getDateTime(e,p.getCdateFormat(e))),T(t,p.getModificationDateClasses(e).replace(/\s+/g,"|"))&&(t.innerHTML=y.getDateTime(e,p.getMdateFormat(e))),T(t,p.getSelectedContentClasses(e).replace(/\s+/g,"|"))&&(t.innerHTML=c)}),x(e,o),e.execCommand("mceInsertContent",!1,o.innerHTML),e.addVisual()},C={createTemplateList:b,replaceTemplateValues:w,replaceVals:x,insertTemplate:k},S=function(e){e.addCommand("mceInsertTemplate",t(C.insertTemplate,e))},P={register:S},D=function(e){e.on("PreProcess",function(t){var r=e.dom,o=p.getMdateFormat(e);n.each(r.select("div",t.node),function(t){r.hasClass(t,"mceTmpl")&&(n.each(r.select("*",t),function(t){r.hasClass(t,e.getParam("template_mdate_classes","mdate").replace(/\s+/g,"|"))&&(t.innerHTML=y.getDateTime(e,o))}),C.replaceVals(e,t))})})},I={setup:D},_=function(e,t,r){if(-1===r.indexOf("<html>")){var o="";n.each(e.contentCSS,function(t){o+='<link type="text/css" rel="stylesheet" href="'+e.documentBaseURI.toAbsolute(t)+'">'});var i=e.settings.body_class||"";-1!==i.indexOf("=")&&(i=e.getParam("body_class","","hash"),i=i[e.id]||""),r="<!DOCTYPE html><html><head>"+o+'</head><body class="'+i+'">'+r+"</body></html>"}r=C.replaceTemplateValues(e,r,p.getPreviewReplaceValues(e));var a=t.find("iframe")[0].getEl().contentWindow.document;a.open(),a.write(r),a.close()},N=function(e,t){var o,i,a=[];if(t&&0!==t.length){n.each(t,function(e){a.push({selected:!a.length,text:e.title,value:{url:e.url,content:e.content,description:e.description}})});var c=function(t){var n=t.control.value();n.url?r.send({url:n.url,success:function(t){i=t,_(e,o,i)}}):(i=n.content,_(e,o,i)),o.find("#description")[0].text(t.control.value().description)};o=e.windowManager.open({title:"Insert template",layout:"flex",direction:"column",align:"stretch",padding:15,spacing:10,items:[{type:"form",flex:0,padding:0,items:[{type:"container",label:"Templates",items:{type:"listbox",label:"Templates",name:"template",values:a,onselect:c}}]},{type:"label",name:"description",label:"Description",text:" "},{type:"iframe",flex:1,border:1}],onsubmit:function(){C.insertTemplate(e,!1,i)},minWidth:p.getDialogWidth(e),minHeight:p.getDialogHeight(e)}),o.find("listbox")[0].fire("select")}else{var u=e.translate("No templates defined.");e.notificationManager.open({text:u,type:"info"})}},M={open:N},E=function(e){return function(t){M.open(e,t)}},A=function(e){e.addButton("template",{title:"Insert template",onclick:C.createTemplateList(e.settings,E(e))}),e.addMenuItem("template",{text:"Template",onclick:C.createTemplateList(e.settings,E(e)),icon:"template",context:"insert"})},O={register:A};function R(){}e.add("template",function(e){O.register(e),P.register(e),I.setup(e)})})()})()},"169f":function(e,t){(function(){(function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=function(e){return/^[A-Za-z][A-Za-z0-9\-:._]*$/.test(e)},n=function(e){var t=e.selection.getNode(),n="A"===t.tagName&&""===e.dom.getAttrib(t,"href");return n?t.id||t.name:""},r=function(e,t){var n=e.selection.getNode(),r="A"===n.tagName&&""===e.dom.getAttrib(n,"href");r?(n.removeAttribute("name"),n.id=t,e.undoManager.add()):(e.focus(),e.selection.collapse(!0),e.execCommand("mceInsertContent",!1,e.dom.createHTML("a",{id:t})))},o={isValidId:t,getId:n,insert:r},i=function(e,t){return o.isValidId(t)?(o.insert(e,t),!1):(e.windowManager.alert("Id should start with a letter, followed only by letters, numbers, dashes, dots, colons or underscores."),!0)},a=function(e){var t=o.getId(e);e.windowManager.open({title:"Anchor",body:{type:"textbox",name:"id",size:40,label:"Id",value:t},onsubmit:function(t){var n=t.data.id;i(e,n)&&t.preventDefault()}})},c={open:a},u=function(e){e.addCommand("mceAnchor",function(){c.open(e)})},l={register:u},s=function(e){return!e.attr("href")&&(e.attr("id")||e.attr("name"))&&!e.firstChild},f=function(e){return function(t){for(var n=0;n<t.length;n++)s(t[n])&&t[n].attr("contenteditable",e)}},d=function(e){e.on("PreInit",function(){e.parser.addNodeFilter("a",f("false")),e.serializer.addNodeFilter("a",f(null))})},m={setup:d},g=function(e){e.addButton("anchor",{icon:"anchor",tooltip:"Anchor",cmd:"mceAnchor",stateSelector:"a:not([href])"}),e.addMenuItem("anchor",{icon:"anchor",text:"Anchor",context:"insert",cmd:"mceAnchor"})},p={register:g};function h(){}e.add("anchor",function(e){m.setup(e),l.register(e),p.register(e)})})()})()},"16f1":function(e,t){(function(){(function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=function(e,t){return e.fire("insertCustomChar",{chr:t})},n={fireInsertCustomChar:t},r=function(e,t){var r=n.fireInsertCustomChar(e,t).chr;e.execCommand("mceInsertContent",!1,r)},o={insertChar:r},i=tinymce.util.Tools.resolve("tinymce.util.Tools"),a=function(e){return e.settings.charmap},c=function(e){return e.settings.charmap_append},u={getCharMap:a,getCharMapAppend:c},l=i.isArray,s=function(){return[["160","no-break space"],["173","soft hyphen"],["34","quotation mark"],["162","cent sign"],["8364","euro sign"],["163","pound sign"],["165","yen sign"],["169","copyright sign"],["174","registered sign"],["8482","trade mark sign"],["8240","per mille sign"],["181","micro sign"],["183","middle dot"],["8226","bullet"],["8230","three dot leader"],["8242","minutes / feet"],["8243","seconds / inches"],["167","section sign"],["182","paragraph sign"],["223","sharp s / ess-zed"],["8249","single left-pointing angle quotation mark"],["8250","single right-pointing angle quotation mark"],["171","left pointing guillemet"],["187","right pointing guillemet"],["8216","left single quotation mark"],["8217","right single quotation mark"],["8220","left double quotation mark"],["8221","right double quotation mark"],["8218","single low-9 quotation mark"],["8222","double low-9 quotation mark"],["60","less-than sign"],["62","greater-than sign"],["8804","less-than or equal to"],["8805","greater-than or equal to"],["8211","en dash"],["8212","em dash"],["175","macron"],["8254","overline"],["164","currency sign"],["166","broken bar"],["168","diaeresis"],["161","inverted exclamation mark"],["191","turned question mark"],["710","circumflex accent"],["732","small tilde"],["176","degree sign"],["8722","minus sign"],["177","plus-minus sign"],["247","division sign"],["8260","fraction slash"],["215","multiplication sign"],["185","superscript one"],["178","superscript two"],["179","superscript three"],["188","fraction one quarter"],["189","fraction one half"],["190","fraction three quarters"],["402","function / florin"],["8747","integral"],["8721","n-ary sumation"],["8734","infinity"],["8730","square root"],["8764","similar to"],["8773","approximately equal to"],["8776","almost equal to"],["8800","not equal to"],["8801","identical to"],["8712","element of"],["8713","not an element of"],["8715","contains as member"],["8719","n-ary product"],["8743","logical and"],["8744","logical or"],["172","not sign"],["8745","intersection"],["8746","union"],["8706","partial differential"],["8704","for all"],["8707","there exists"],["8709","diameter"],["8711","backward difference"],["8727","asterisk operator"],["8733","proportional to"],["8736","angle"],["180","acute accent"],["184","cedilla"],["170","feminine ordinal indicator"],["186","masculine ordinal indicator"],["8224","dagger"],["8225","double dagger"],["192","A - grave"],["193","A - acute"],["194","A - circumflex"],["195","A - tilde"],["196","A - diaeresis"],["197","A - ring above"],["256","A - macron"],["198","ligature AE"],["199","C - cedilla"],["200","E - grave"],["201","E - acute"],["202","E - circumflex"],["203","E - diaeresis"],["274","E - macron"],["204","I - grave"],["205","I - acute"],["206","I - circumflex"],["207","I - diaeresis"],["298","I - macron"],["208","ETH"],["209","N - tilde"],["210","O - grave"],["211","O - acute"],["212","O - circumflex"],["213","O - tilde"],["214","O - diaeresis"],["216","O - slash"],["332","O - macron"],["338","ligature OE"],["352","S - caron"],["217","U - grave"],["218","U - acute"],["219","U - circumflex"],["220","U - diaeresis"],["362","U - macron"],["221","Y - acute"],["376","Y - diaeresis"],["562","Y - macron"],["222","THORN"],["224","a - grave"],["225","a - acute"],["226","a - circumflex"],["227","a - tilde"],["228","a - diaeresis"],["229","a - ring above"],["257","a - macron"],["230","ligature ae"],["231","c - cedilla"],["232","e - grave"],["233","e - acute"],["234","e - circumflex"],["235","e - diaeresis"],["275","e - macron"],["236","i - grave"],["237","i - acute"],["238","i - circumflex"],["239","i - diaeresis"],["299","i - macron"],["240","eth"],["241","n - tilde"],["242","o - grave"],["243","o - acute"],["244","o - circumflex"],["245","o - tilde"],["246","o - diaeresis"],["248","o slash"],["333","o macron"],["339","ligature oe"],["353","s - caron"],["249","u - grave"],["250","u - acute"],["251","u - circumflex"],["252","u - diaeresis"],["363","u - macron"],["253","y - acute"],["254","thorn"],["255","y - diaeresis"],["563","y - macron"],["913","Alpha"],["914","Beta"],["915","Gamma"],["916","Delta"],["917","Epsilon"],["918","Zeta"],["919","Eta"],["920","Theta"],["921","Iota"],["922","Kappa"],["923","Lambda"],["924","Mu"],["925","Nu"],["926","Xi"],["927","Omicron"],["928","Pi"],["929","Rho"],["931","Sigma"],["932","Tau"],["933","Upsilon"],["934","Phi"],["935","Chi"],["936","Psi"],["937","Omega"],["945","alpha"],["946","beta"],["947","gamma"],["948","delta"],["949","epsilon"],["950","zeta"],["951","eta"],["952","theta"],["953","iota"],["954","kappa"],["955","lambda"],["956","mu"],["957","nu"],["958","xi"],["959","omicron"],["960","pi"],["961","rho"],["962","final sigma"],["963","sigma"],["964","tau"],["965","upsilon"],["966","phi"],["967","chi"],["968","psi"],["969","omega"],["8501","alef symbol"],["982","pi symbol"],["8476","real part symbol"],["978","upsilon - hook symbol"],["8472","Weierstrass p"],["8465","imaginary part"],["8592","leftwards arrow"],["8593","upwards arrow"],["8594","rightwards arrow"],["8595","downwards arrow"],["8596","left right arrow"],["8629","carriage return"],["8656","leftwards double arrow"],["8657","upwards double arrow"],["8658","rightwards double arrow"],["8659","downwards double arrow"],["8660","left right double arrow"],["8756","therefore"],["8834","subset of"],["8835","superset of"],["8836","not a subset of"],["8838","subset of or equal to"],["8839","superset of or equal to"],["8853","circled plus"],["8855","circled times"],["8869","perpendicular"],["8901","dot operator"],["8968","left ceiling"],["8969","right ceiling"],["8970","left floor"],["8971","right floor"],["9001","left-pointing angle bracket"],["9002","right-pointing angle bracket"],["9674","lozenge"],["9824","black spade suit"],["9827","black club suit"],["9829","black heart suit"],["9830","black diamond suit"],["8194","en space"],["8195","em space"],["8201","thin space"],["8204","zero width non-joiner"],["8205","zero width joiner"],["8206","left-to-right mark"],["8207","right-to-left mark"]]},f=function(e){return i.grep(e,function(e){return l(e)&&2===e.length})},d=function(e){return l(e)?[].concat(f(e)):"function"===typeof e?e():[]},m=function(e,t){var n=u.getCharMap(e);n&&(t=d(n));var r=u.getCharMapAppend(e);return r?[].concat(t).concat(d(r)):t},g=function(e){return m(e,s())},p={getCharMap:g},h=function(e){var t=function(){return p.getCharMap(e)},n=function(t){o.insertChar(e,t)};return{getCharMap:t,insertChar:n}},v={get:h},y=function(e){var t,n,r,o=Math.min(e.length,25),i=Math.ceil(e.length/o);for(t='<table role="presentation" cellspacing="0" class="mce-charmap"><tbody>',r=0;r<i;r++){for(t+="<tr>",n=0;n<o;n++){var a=r*o+n;if(a<e.length){var c=e[a],u=parseInt(c[0],10),l=c?String.fromCharCode(u):"&nbsp;";t+='<td title="'+c[1]+'"><div tabindex="-1" title="'+c[1]+'" role="button" data-chr="'+u+'">'+l+"</div></td>"}else t+="<td />"}t+="</tr>"}return t+="</tbody></table>",t},b={getHtml:y},w=function(e){while(e){if("TD"===e.nodeName)return e;e=e.parentNode}},x=function(e){var t,n={type:"container",html:b.getHtml(p.getCharMap(e)),onclick:function(n){var r=n.target;if(/^(TD|DIV)$/.test(r.nodeName)){var i=w(r).firstChild;if(i&&i.hasAttribute("data-chr")){var a=i.getAttribute("data-chr"),c=parseInt(a,10);isNaN(c)||o.insertChar(e,String.fromCharCode(c)),n.ctrlKey||t.close()}}},onmouseover:function(e){var n=w(e.target);n&&n.firstChild?(t.find("#preview").text(n.firstChild.firstChild.data),t.find("#previewTitle").text(n.title)):(t.find("#preview").text(" "),t.find("#previewTitle").text(" "))}};t=e.windowManager.open({title:"Special character",spacing:10,padding:10,items:[n,{type:"container",layout:"flex",direction:"column",align:"center",spacing:5,minWidth:160,minHeight:160,items:[{type:"label",name:"preview",text:" ",style:"font-size: 40px; text-align: center",border:1,minWidth:140,minHeight:80},{type:"spacer",minHeight:20},{type:"label",name:"previewTitle",text:" ",style:"white-space: pre-wrap;",border:1,minWidth:140}]}],buttons:[{text:"Close",onclick:function(){t.close()}}]})},T={open:x},k=function(e){e.addCommand("mceShowCharmap",function(){T.open(e)})},C={register:k},S=function(e){e.addButton("charmap",{icon:"charmap",tooltip:"Special character",cmd:"mceShowCharmap"}),e.addMenuItem("charmap",{icon:"charmap",text:"Special character",cmd:"mceShowCharmap",context:"insert"})},P={register:S};function D(){}e.add("charmap",function(e){return C.register(e),P.register(e),v.get(e)})})()})()},2519:function(e,t){(function(){(function(){"use strict";var e=function(t){var n=t,r=function(){return n},o=function(e){n=e},i=function(){return e(r())};return{get:r,set:o,clone:i}},t=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=tinymce.util.Tools.resolve("tinymce.util.Tools");function r(e){return e&&1===e.nodeType&&"false"===e.contentEditable}function o(e,t,n,o,i){var a,c,u,l,s,f,d=[],m=0;function g(e,t){if(t=t||0,!e[0])throw new Error("findAndReplaceDOMText cannot handle zero-length matches");var n=e.index;if(t>0){var r=e[t];if(!r)throw new Error("Invalid capture group");n+=e[0].indexOf(r),e[0]=r}return[n,n+e[0].length,[e[0]]]}function p(e){var t;if(3===e.nodeType)return e.data;if(s[e.nodeName]&&!l[e.nodeName])return"";if(t="",r(e))return"\n";if((l[e.nodeName]||f[e.nodeName])&&(t+="\n"),e=e.firstChild)do{t+=p(e)}while(e=e.nextSibling);return t}function h(e,t,n){var o,i,a,c,u=[],d=0,m=e,g=t.shift(),p=0;e:while(1){if((l[m.nodeName]||f[m.nodeName]||r(m))&&d++,3===m.nodeType&&(!i&&m.length+d>=g[1]?(i=m,c=g[1]-d):o&&u.push(m),!o&&m.length+d>g[0]&&(o=m,a=g[0]-d),d+=m.length),o&&i){if(m=n({startNode:o,startNodeIndex:a,endNode:i,endNodeIndex:c,innerNodes:u,match:g[2],matchIndex:p}),d-=i.length-c,o=null,i=null,u=[],g=t.shift(),p++,!g)break}else if(s[m.nodeName]&&!l[m.nodeName]||!m.firstChild){if(m.nextSibling){m=m.nextSibling;continue}}else if(!r(m)){m=m.firstChild;continue}while(1){if(m.nextSibling){m=m.nextSibling;break}if(m.parentNode===e)break e;m=m.parentNode}}}function v(e){var t;if("function"!==typeof e){var n=e.nodeType?e:u.createElement(e);t=function(e,t){var r=n.cloneNode(!1);return r.setAttribute("data-mce-index",t),e&&r.appendChild(u.createTextNode(e)),r}}else t=e;return function(e){var n,r,o,i=e.startNode,a=e.endNode,c=e.matchIndex;if(i===a){var l=i;o=l.parentNode,e.startNodeIndex>0&&(n=u.createTextNode(l.data.substring(0,e.startNodeIndex)),o.insertBefore(n,l));var s=t(e.match[0],c);return o.insertBefore(s,l),e.endNodeIndex<l.length&&(r=u.createTextNode(l.data.substring(e.endNodeIndex)),o.insertBefore(r,l)),l.parentNode.removeChild(l),s}n=u.createTextNode(i.data.substring(0,e.startNodeIndex)),r=u.createTextNode(a.data.substring(e.endNodeIndex));for(var f=t(i.data.substring(e.startNodeIndex),c),d=0,m=e.innerNodes.length;d<m;++d){var g=e.innerNodes[d],p=t(g.data,c);g.parentNode.replaceChild(p,g)}var h=t(a.data.substring(0,e.endNodeIndex),c);return o=i.parentNode,o.insertBefore(n,i),o.insertBefore(f,i),o.removeChild(i),o=a.parentNode,o.insertBefore(h,a),o.insertBefore(r,a),o.removeChild(a),h}}if(u=t.ownerDocument,l=i.getBlockElements(),s=i.getWhiteSpaceElements(),f=i.getShortEndedElements(),c=p(t),c){if(e.global)while(a=e.exec(c))d.push(g(a,o));else a=c.match(e),d.push(g(a,o));return d.length&&(m=d.length,h(t,d,v(n))),m}}var i={findAndReplaceDOMText:o},a=function(e){var t=e.getAttribute("data-mce-index");return"number"===typeof t?""+t:t},c=function(e,t,n){var r,o;return o=e.dom.create("span",{"data-mce-bogus":1}),o.className="mce-match-marker",r=e.getBody(),v(e,t,!1),i.findAndReplaceDOMText(n,r,o,!1,e.schema)},u=function(e){var t=e.parentNode;e.firstChild&&t.insertBefore(e.firstChild,e),e.parentNode.removeChild(e)},l=function(e,t){var r,o=[];if(r=n.toArray(e.getBody().getElementsByTagName("span")),r.length)for(var i=0;i<r.length;i++){var c=a(r[i]);null!==c&&c.length&&(c===t.toString()&&o.push(r[i]))}return o},s=function(e,t,n){var r=t.get(),o=e.dom;n=!1!==n,n?r++:r--,o.removeClass(l(e,t.get()),"mce-match-marker-selected");var i=l(e,r);return i.length?(o.addClass(l(e,r),"mce-match-marker-selected"),e.selection.scrollIntoView(i[0]),r):-1},f=function(e,t){var n=t.parentNode;e.remove(t),e.isEmpty(n)&&e.remove(n)},d=function(e,t,n,r,o){n=n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),n=n.replace(/\s/g,"[^\\S\\r\\n]"),n=o?"\\b"+n+"\\b":n;var i=c(e,t,new RegExp(n,r?"g":"gi"));return i&&(t.set(-1),t.set(s(e,t,!0))),i},m=function(e,t){var n=s(e,t,!0);-1!==n&&t.set(n)},g=function(e,t){var n=s(e,t,!1);-1!==n&&t.set(n)},p=function(e){var t=a(e);return null!==t&&t.length>0},h=function(e,t,r,o,i){var c,l,s,d,h,v,w=t.get();for(o=!1!==o,s=e.getBody(),l=n.grep(n.toArray(s.getElementsByTagName("span")),p),c=0;c<l.length;c++){var x=a(l[c]);if(d=h=parseInt(x,10),i||d===t.get()){r.length?(l[c].firstChild.nodeValue=r,u(l[c])):f(e.dom,l[c]);while(l[++c]){if(d=parseInt(a(l[c]),10),d!==h){c--;break}f(e.dom,l[c])}o&&w--}else h>t.get()&&l[c].setAttribute("data-mce-index",h-1)}return t.set(w),o?(v=y(e,t),m(e,t)):(v=b(e,t),g(e,t)),!i&&v},v=function(e,t,r){var o,i,c,l;for(i=n.toArray(e.getBody().getElementsByTagName("span")),o=0;o<i.length;o++){var s=a(i[o]);null!==s&&s.length&&(s===t.get().toString()&&(c||(c=i[o].firstChild),l=i[o].firstChild),u(i[o]))}if(c&&l){var f=e.dom.createRng();return f.setStart(c,0),f.setEnd(l,l.data.length),!1!==r&&e.selection.setRng(f),f}},y=function(e,t){return l(e,t.get()+1).length>0},b=function(e,t){return l(e,t.get()-1).length>0},w={done:v,find:d,next:m,prev:g,replace:h,hasNext:y,hasPrev:b},x=function(e,t){var n=function(n){return w.done(e,t,n)},r=function(n,r,o){return w.find(e,t,n,r,o)},o=function(){return w.next(e,t)},i=function(){return w.prev(e,t)},a=function(n,r,o){return w.replace(e,t,n,r,o)};return{done:n,find:r,next:o,prev:i,replace:a}},T={get:x},k=function(e,t){var r,o={};function i(){c.statusbar.find("#next").disabled(!1===w.hasNext(e,t)),c.statusbar.find("#prev").disabled(!1===w.hasPrev(e,t))}function a(){e.windowManager.alert("Could not find the specified string.",function(){c.find("#find")[0].focus()})}e.undoManager.add(),r=n.trim(e.selection.getContent({format:"text"}));var c=e.windowManager.open({layout:"flex",pack:"center",align:"center",onClose:function(){e.focus(),w.done(e,t),e.undoManager.add()},onSubmit:function(n){var r,u,l,s;return n.preventDefault(),u=c.find("#case").checked(),s=c.find("#words").checked(),l=c.find("#find").value(),l.length?o.text===l&&o.caseState===u&&o.wholeWord===s?w.hasNext(e,t)?(w.next(e,t),void i()):void a():(r=w.find(e,t,l,u,s),r||a(),c.statusbar.items().slice(1).disabled(0===r),i(),void(o={text:l,caseState:u,wholeWord:s})):(w.done(e,t,!1),void c.statusbar.items().slice(1).disabled(!0))},buttons:[{text:"Find",subtype:"primary",onclick:function(){c.submit()}},{text:"Replace",disabled:!0,onclick:function(){w.replace(e,t,c.find("#replace").value())||(c.statusbar.items().slice(1).disabled(!0),t.set(-1),o={})}},{text:"Replace all",disabled:!0,onclick:function(){w.replace(e,t,c.find("#replace").value(),!0,!0),c.statusbar.items().slice(1).disabled(!0),o={}}},{type:"spacer",flex:1},{text:"Prev",name:"prev",disabled:!0,onclick:function(){w.prev(e,t),i()}},{text:"Next",name:"next",disabled:!0,onclick:function(){w.next(e,t),i()}}],title:"Find and replace",items:{type:"form",padding:20,labelGap:30,spacing:10,items:[{type:"textbox",name:"find",size:40,label:"Find",value:r},{type:"textbox",name:"replace",size:40,label:"Replace with"},{type:"checkbox",name:"case",text:"Match case",label:" "},{type:"checkbox",name:"words",text:"Whole words",label:" "}]}})},C={open:k},S=function(e,t){e.addCommand("SearchReplace",function(){C.open(e,t)})},P={register:S},D=function(e,t){return function(){C.open(e,t)}},I=function(e,t){e.addMenuItem("searchreplace",{text:"Find and replace",shortcut:"Meta+F",onclick:D(e,t),separator:"before",context:"edit"}),e.addButton("searchreplace",{tooltip:"Find and replace",onclick:D(e,t)}),e.shortcuts.add("Meta+F","",D(e,t))},_={register:I};function N(){}t.add("searchreplace",function(t){var n=e(-1);return P.register(t,n),_.register(t,n),T.get(t,n)})})()})()},"2b07":function(e,t,n){n("dbbc")},3154:function(e,t,n){n("f034")},"365e":function(e,t,n){n("cf08")},3699:function(e,t){(function(){(function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.Env"),n=tinymce.util.Tools.resolve("tinymce.util.Tools"),r=function(e){return e.getParam("media_scripts")},o=function(e){return e.getParam("audio_template_callback")},i=function(e){return e.getParam("video_template_callback")},a=function(e){return e.getParam("media_live_embeds",!0)},c=function(e){return e.getParam("media_filter_html",!0)},u=function(e){return e.getParam("media_url_resolver")},l=function(e){return e.getParam("media_alt_source",!0)},s=function(e){return e.getParam("media_poster",!0)},f=function(e){return e.getParam("media_dimensions",!0)},d={getScripts:r,getAudioTemplateCallback:o,getVideoTemplateCallback:i,hasLiveEmbeds:a,shouldFilterHtml:c,getUrlResolver:u,hasAltSource:l,hasPoster:s,hasDimensions:f},m=tinymce.util.Tools.resolve("tinymce.html.SaxParser"),g=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),p=function(e,t){if(e)for(var n=0;n<e.length;n++)if(-1!==t.indexOf(e[n].filter))return e[n]},h={getVideoScriptMatch:p},v=function(e){return e.replace(/px$/,"")},y=function(e){return/^[0-9.]+$/.test(e)?e+"px":e},b=function(e){return function(t){return t?v(t.style[e]):""}},w=function(e){return function(t,n){t&&(t.style[e]=y(n))}},x={getMaxWidth:b("maxWidth"),getMaxHeight:b("maxHeight"),setMaxWidth:w("maxWidth"),setMaxHeight:w("maxHeight")},T=g.DOM,k=function(e){return T.getAttrib(e,"data-ephox-embed-iri")},C=function(e){var t=T.createFragment(e);return""!==k(t.firstChild)},S=function(e,t){var r={};return m({validate:!1,allow_conditional_comments:!0,special:"script,noscript",start:function(t,o){if(r.source1||"param"!==t||(r.source1=o.map.movie),"iframe"!==t&&"object"!==t&&"embed"!==t&&"video"!==t&&"audio"!==t||(r.type||(r.type=t),r=n.extend(o.map,r)),"script"===t){var i=h.getVideoScriptMatch(e,o.map.src);if(!i)return;r={type:"script",source1:o.map.src,width:i.width,height:i.height}}"source"===t&&(r.source1?r.source2||(r.source2=o.map.src):r.source1=o.map.src),"img"!==t||r.poster||(r.poster=o.map.src)}}).parse(t),r.source1=r.source1||r.src||r.data,r.source2=r.source2||"",r.poster=r.poster||"",r},P=function(e){var t=T.createFragment(e),n=t.firstChild;return{type:"ephox-embed-iri",source1:k(n),source2:"",poster:"",width:x.getMaxWidth(n),height:x.getMaxHeight(n)}},D=function(e,t){return C(t)?P(t):S(e,t)},I={htmlToData:D},_=tinymce.util.Tools.resolve("tinymce.util.Promise"),N=function(e){var t={mp3:"audio/mpeg",wav:"audio/wav",mp4:"video/mp4",webm:"video/webm",ogg:"video/ogg",swf:"application/x-shockwave-flash"},n=e.toLowerCase().split(".").pop(),r=t[n];return r||""},M={guess:N},E=tinymce.util.Tools.resolve("tinymce.html.Writer"),A=tinymce.util.Tools.resolve("tinymce.html.Schema"),O=g.DOM,R=function(e,t){var n,r,o,i;for(n in t)if(o=""+t[n],e.map[n]){r=e.length;while(r--)i=e[r],i.name===n&&(o?(e.map[n]=o,i.value=o):(delete e.map[n],e.splice(r,1)))}else o&&(e.push({name:n,value:o}),e.map[n]=o)},F=function(e){var t=E(),n=m(t);return n.parse(e),t.getContent()},B=function(e,t,n){var r,o=E(),i=0;return m({validate:!1,allow_conditional_comments:!0,special:"script,noscript",comment:function(e){o.comment(e)},cdata:function(e){o.cdata(e)},text:function(e,t){o.text(e,t)},start:function(e,a,c){switch(e){case"video":case"object":case"embed":case"img":case"iframe":void 0!==t.height&&void 0!==t.width&&R(a,{width:t.width,height:t.height});break}if(n)switch(e){case"video":R(a,{poster:t.poster,src:""}),t.source2&&R(a,{src:""});break;case"iframe":R(a,{src:t.source1});break;case"source":if(i++,i<=2&&(R(a,{src:t["source"+i],type:t["source"+i+"mime"]}),!t["source"+i]))return;break;case"img":if(!t.poster)return;r=!0;break}o.start(e,a,c)},end:function(e){if("video"===e&&n)for(var a=1;a<=2;a++)if(t["source"+a]){var c=[];c.map={},i<a&&(R(c,{src:t["source"+a],type:t["source"+a+"mime"]}),o.start("source",c,!0))}if(t.poster&&"object"===e&&n&&!r){var u=[];u.map={},R(u,{src:t.poster,width:t.width,height:t.height}),o.start("img",u,!0)}o.end(e)}},A({})).parse(e),o.getContent()},H=function(e){var t=O.createFragment(e);return""!==O.getAttrib(t.firstChild,"data-ephox-embed-iri")},L=function(e,t){var n=O.createFragment(e),r=n.firstChild;return x.setMaxWidth(r,t.width),x.setMaxHeight(r,t.height),F(r.outerHTML)},U=function(e,t,n){return H(e)?L(e,t):B(e,t,n)},j={updateHtml:U},z=[{regex:/youtu\.be\/([\w\-_\?&=.]+)/i,type:"iframe",w:560,h:314,url:"//www.youtube.com/embed/$1",allowFullscreen:!0},{regex:/youtube\.com(.+)v=([^&]+)(&([a-z0-9&=\-_]+))?/i,type:"iframe",w:560,h:314,url:"//www.youtube.com/embed/$2?$4",allowFullscreen:!0},{regex:/youtube.com\/embed\/([a-z0-9\?&=\-_]+)/i,type:"iframe",w:560,h:314,url:"//www.youtube.com/embed/$1",allowFullscreen:!0},{regex:/vimeo\.com\/([0-9]+)/,type:"iframe",w:425,h:350,url:"//player.vimeo.com/video/$1?title=0&byline=0&portrait=0&color=8dc7dc",allowFullscreen:!0},{regex:/vimeo\.com\/(.*)\/([0-9]+)/,type:"iframe",w:425,h:350,url:"//player.vimeo.com/video/$2?title=0&amp;byline=0",allowFullscreen:!0},{regex:/maps\.google\.([a-z]{2,3})\/maps\/(.+)msid=(.+)/,type:"iframe",w:425,h:350,url:'//maps.google.com/maps/ms?msid=$2&output=embed"',allowFullscreen:!1},{regex:/dailymotion\.com\/video\/([^_]+)/,type:"iframe",w:480,h:270,url:"//www.dailymotion.com/embed/video/$1",allowFullscreen:!0},{regex:/dai\.ly\/([^_]+)/,type:"iframe",w:480,h:270,url:"//www.dailymotion.com/embed/video/$1",allowFullscreen:!0}],W=function(e,t){for(var n=e.regex.exec(t),r=e.url,o=function(e){r=r.replace("$"+e,function(){return n[e]?n[e]:""})},i=0;i<n.length;i++)o(i);return r.replace(/\?$/,"")},V=function(e){var t=z.filter(function(t){return t.regex.test(e)});return t.length>0?n.extend({},t[0],{url:W(t[0],e)}):null},G=function(e){var t=e.allowFullscreen?' allowFullscreen="1"':"";return'<iframe src="'+e.source1+'" width="'+e.width+'" height="'+e.height+'"'+t+"></iframe>"},$=function(e){var t='<object data="'+e.source1+'" width="'+e.width+'" height="'+e.height+'" type="application/x-shockwave-flash">';return e.poster&&(t+='<img src="'+e.poster+'" width="'+e.width+'" height="'+e.height+'" />'),t+="</object>",t},q=function(e,t){return t?t(e):'<audio controls="controls" src="'+e.source1+'">'+(e.source2?'\n<source src="'+e.source2+'"'+(e.source2mime?' type="'+e.source2mime+'"':"")+" />\n":"")+"</audio>"},Y=function(e,t){return t?t(e):'<video width="'+e.width+'" height="'+e.height+'"'+(e.poster?' poster="'+e.poster+'"':"")+' controls="controls">\n<source src="'+e.source1+'"'+(e.source1mime?' type="'+e.source1mime+'"':"")+" />\n"+(e.source2?'<source src="'+e.source2+'"'+(e.source2mime?' type="'+e.source2mime+'"':"")+" />\n":"")+"</video>"},J=function(e){return'<script src="'+e.source1+'"><\/script>'},X=function(e,t){var r=n.extend({},t);if(!r.source1&&(n.extend(r,I.htmlToData(d.getScripts(e),r.embed)),!r.source1))return"";r.source2||(r.source2=""),r.poster||(r.poster=""),r.source1=e.convertURL(r.source1,"source"),r.source2=e.convertURL(r.source2,"source"),r.source1mime=M.guess(r.source1),r.source2mime=M.guess(r.source2),r.poster=e.convertURL(r.poster,"poster");var o=V(r.source1);if(o&&(r.source1=o.url,r.type=o.type,r.allowFullscreen=o.allowFullscreen,r.width=r.width||o.w,r.height=r.height||o.h),r.embed)return j.updateHtml(r.embed,r,!0);var i=h.getVideoScriptMatch(d.getScripts(e),r.source1);i&&(r.type="script",r.width=i.width,r.height=i.height);var a=d.getAudioTemplateCallback(e),c=d.getVideoTemplateCallback(e);return r.width=r.width||300,r.height=r.height||150,n.each(r,function(t,n){r[n]=e.dom.encode(t)}),"iframe"===r.type?G(r):"application/x-shockwave-flash"===r.source1mime?$(r):-1!==r.source1mime.indexOf("audio")?q(r,a):"script"===r.type?J(r):Y(r,c)},K={dataToHtml:X},Z={},Q=function(e,t,n){return new _(function(r,o){var i=function(n){return n.html&&(Z[e.source1]=n),r({url:e.source1,html:n.html?n.html:t(e)})};Z[e.source1]?i(Z[e.source1]):n({url:e.source1},i,o)})},ee=function(e,t){return new _(function(n){n({html:t(e),url:e.source1})})},te=function(e){return function(t){return K.dataToHtml(e,t)}},ne=function(e,t){var n=d.getUrlResolver(e);return n?Q(t,te(e),n):ee(t,te(e))},re=function(e){return Z.hasOwnProperty(e)},oe={getEmbedHtml:ne,isCached:re},ie=function(e,t){e.state.set("oldVal",e.value()),t.state.set("oldVal",t.value())},ae=function(e,t){var n=e.find("#width")[0],r=e.find("#height")[0],o=e.find("#constrain")[0];n&&r&&o&&t(n,r,o.checked())},ce=function(e,t,n){var r=e.state.get("oldVal"),o=t.state.get("oldVal"),i=e.value(),a=t.value();n&&r&&o&&i&&a&&(i!==r?(a=Math.round(i/r*a),isNaN(a)||t.value(a)):(i=Math.round(a/o*i),isNaN(i)||e.value(i))),ie(e,t)},ue=function(e){ae(e,ie)},le=function(e){ae(e,ce)},se=function(e){var t=function(){e(function(e){le(e)})};return{type:"container",label:"Dimensions",layout:"flex",align:"center",spacing:5,items:[{name:"width",type:"textbox",maxLength:5,size:5,onchange:t,ariaLabel:"Width"},{type:"label",text:"x"},{name:"height",type:"textbox",maxLength:5,size:5,onchange:t,ariaLabel:"Height"},{name:"constrain",type:"checkbox",checked:!0,text:"Constrain proportions"}]}},fe={createUi:se,syncSize:ue,updateSize:le},de=t.ie&&t.ie<=8?"onChange":"onInput",me=function(e){return function(t){var n=t&&t.msg?"Media embed handler error: "+t.msg:"Media embed handler threw unknown error.";e.notificationManager.open({type:"error",text:n})}},ge=function(e){var t=e.selection.getNode(),n=t.getAttribute("data-ephox-embed-iri");return n?{source1:n,"data-ephox-embed-iri":n,width:x.getMaxWidth(t),height:x.getMaxHeight(t)}:t.getAttribute("data-mce-object")?I.htmlToData(d.getScripts(e),e.serializer.serialize(t,{selection:!0})):{}},pe=function(e){var t=e.selection.getNode();if(t.getAttribute("data-mce-object")||t.getAttribute("data-ephox-embed-iri"))return e.selection.getContent()},he=function(e,t){return function(r){var o=r.html,i=e.find("#embed")[0],a=n.extend(I.htmlToData(d.getScripts(t),o),{source1:r.url});e.fromJSON(a),i&&(i.value(o),fe.updateSize(e))}},ve=function(e,t){var n,r,o=e.dom.select("img[data-mce-object]");for(n=0;n<t.length;n++)for(r=o.length-1;r>=0;r--)t[n]===o[r]&&o.splice(r,1);e.selection.select(o[0])},ye=function(e,t){var n=e.dom.select("img[data-mce-object]");e.insertContent(t),ve(e,n),e.nodeChanged()},be=function(e,t){var n=e.toJSON();n.embed=j.updateHtml(n.embed,n),n.embed&&oe.isCached(n.source1)?ye(t,n.embed):oe.getEmbedHtml(t,n).then(function(e){ye(t,e.html)}).catch(me(t))},we=function(e,t){n.each(t,function(t,n){e.find("#"+n).value(t)})},xe=function(e){var t,r,o=[{name:"source1",type:"filepicker",filetype:"media",size:40,autofocus:!0,label:"Source",onpaste:function(){setTimeout(function(){oe.getEmbedHtml(e,t.toJSON()).then(he(t,e)).catch(me(e))},1)},onchange:function(n){oe.getEmbedHtml(e,t.toJSON()).then(he(t,e)).catch(me(e)),we(t,n.meta)},onbeforecall:function(e){e.meta=t.toJSON()}}],i=[],a=function(e){e(t),r=t.toJSON(),t.find("#embed").value(j.updateHtml(r.embed,r))};if(d.hasAltSource(e)&&i.push({name:"source2",type:"filepicker",filetype:"media",size:40,label:"Alternative source"}),d.hasPoster(e)&&i.push({name:"poster",type:"filepicker",filetype:"image",size:40,label:"Poster"}),d.hasDimensions(e)){var c=fe.createUi(a);o.push(c)}r=ge(e);var u={id:"mcemediasource",type:"textbox",flex:1,name:"embed",value:pe(e),multiline:!0,rows:5,label:"Source"},l=function(){r=n.extend({},I.htmlToData(d.getScripts(e),this.value())),this.parent().parent().fromJSON(r)};u[de]=l;var s=[{title:"General",type:"form",items:o},{title:"Embed",type:"container",layout:"flex",direction:"column",align:"stretch",padding:10,spacing:10,items:[{type:"label",text:"Paste your embed code below:",forId:"mcemediasource"},u]}];i.length>0&&s.push({title:"Advanced",type:"form",items:i}),t=e.windowManager.open({title:"Insert/edit media",data:r,bodyType:"tabpanel",body:s,onSubmit:function(){fe.updateSize(t),be(t,e)}}),fe.syncSize(t)},Te={showDialog:xe},ke=function(e){var t=function(){Te.showDialog(e)};return{showDialog:t}},Ce={get:ke},Se=function(e){var t=function(){Te.showDialog(e)};e.addCommand("mceMedia",t)},Pe={register:Se},De=tinymce.util.Tools.resolve("tinymce.html.Node"),Ie=function(e,t){if(!1===d.shouldFilterHtml(e))return t;var n,r=E();return m({validate:!1,allow_conditional_comments:!1,special:"script,noscript",comment:function(e){r.comment(e)},cdata:function(e){r.cdata(e)},text:function(e,t){r.text(e,t)},start:function(t,o,i){if(n=!0,"script"!==t&&"noscript"!==t){for(var a=0;a<o.length;a++){if(0===o[a].name.indexOf("on"))return;"style"===o[a].name&&(o[a].value=e.dom.serializeStyle(e.dom.parseStyle(o[a].value),t))}r.start(t,o,i),n=!1}},end:function(e){n||r.end(e)}},A({})).parse(t),r.getContent()},_e={sanitize:Ie},Ne=function(e,n){var r,o=n.name;return r=new De("img",1),r.shortEnded=!0,Ee(e,n,r),r.attr({width:n.attr("width")||"300",height:n.attr("height")||("audio"===o?"30":"150"),style:n.attr("style"),src:t.transparentSrc,"data-mce-object":o,class:"mce-object mce-object-"+o}),r},Me=function(e,t){var n,r,o,i=t.name;return n=new De("span",1),n.attr({contentEditable:"false",style:t.attr("style"),"data-mce-object":i,class:"mce-preview-object mce-object-"+i}),Ee(e,t,n),r=new De(i,1),r.attr({src:t.attr("src"),allowfullscreen:t.attr("allowfullscreen"),style:t.attr("style"),class:t.attr("class"),width:t.attr("width"),height:t.attr("height"),frameborder:"0"}),o=new De("span",1),o.attr("class","mce-shim"),n.append(r),n.append(o),n},Ee=function(e,t,n){var r,o,i,a,c;i=t.attributes,a=i.length;while(a--)r=i[a].name,o=i[a].value,"width"!==r&&"height"!==r&&"style"!==r&&("data"!==r&&"src"!==r||(o=e.convertURL(o,r)),n.attr("data-mce-p-"+r,o));c=t.firstChild&&t.firstChild.value,c&&(n.attr("data-mce-html",escape(_e.sanitize(e,c))),n.firstChild=null)},Ae=function(e){while(e=e.parent)if(e.attr("data-ephox-embed-iri"))return!0;return!1},Oe=function(e){return function(n){var r,o,i=n.length;while(i--)r=n[i],r.parent&&(r.parent.attr("data-mce-object")||("script"!==r.name||(o=h.getVideoScriptMatch(d.getScripts(e),r.attr("src")),o))&&(o&&(o.width&&r.attr("width",o.width.toString()),o.height&&r.attr("height",o.height.toString())),"iframe"===r.name&&d.hasLiveEmbeds(e)&&t.ceFalse?Ae(r)||r.replace(Me(e,r)):Ae(r)||r.replace(Ne(e,r))))}},Re={createPreviewIframeNode:Me,createPlaceholderNode:Ne,placeHolderConverter:Oe},Fe=function(e){e.on("preInit",function(){var t=e.schema.getSpecialElements();n.each("video audio iframe object".split(" "),function(e){t[e]=new RegExp("</"+e+"[^>]*>","gi")});var r=e.schema.getBoolAttrs();n.each("webkitallowfullscreen mozallowfullscreen allowfullscreen".split(" "),function(e){r[e]={}}),e.parser.addNodeFilter("iframe,video,audio,object,embed,script",Re.placeHolderConverter(e)),e.serializer.addAttributeFilter("data-mce-object",function(t,n){var r,o,i,a,c,u,l,s,f=t.length;while(f--)if(r=t[f],r.parent){l=r.attr(n),o=new De(l,1),"audio"!==l&&"script"!==l&&(s=r.attr("class"),s&&-1!==s.indexOf("mce-preview-object")?o.attr({width:r.firstChild.attr("width"),height:r.firstChild.attr("height")}):o.attr({width:r.attr("width"),height:r.attr("height")})),o.attr({style:r.attr("style")}),a=r.attributes,i=a.length;while(i--){var d=a[i].name;0===d.indexOf("data-mce-p-")&&o.attr(d.substr(11),a[i].value)}"script"===l&&o.attr("type","text/javascript"),c=r.attr("data-mce-html"),c&&(u=new De("#text",3),u.raw=!0,u.value=_e.sanitize(e,unescape(c)),o.append(u)),r.replace(o)}})}),e.on("setContent",function(){e.$("span.mce-preview-object").each(function(t,n){var r=e.$(n);0===r.find("span.mce-shim",n).length&&r.append('<span class="mce-shim"></span>')})})},Be={setup:Fe},He=function(e){e.on("ResolveName",function(e){var t;1===e.target.nodeType&&(t=e.target.getAttribute("data-mce-object"))&&(e.name=t)})},Le={setup:He},Ue=function(e){e.on("click keyup",function(){var t=e.selection.getNode();t&&e.dom.hasClass(t,"mce-preview-object")&&e.dom.getAttrib(t,"data-mce-selected")&&t.setAttribute("data-mce-selected","2")}),e.on("ObjectSelected",function(e){var t=e.target.getAttribute("data-mce-object");"audio"!==t&&"script"!==t||e.preventDefault()}),e.on("objectResized",function(e){var t,n=e.target;n.getAttribute("data-mce-object")&&(t=n.getAttribute("data-mce-html"),t&&(t=unescape(t),n.setAttribute("data-mce-html",escape(j.updateHtml(t,{width:e.width,height:e.height})))))})},je={setup:Ue},ze=function(e){e.addButton("media",{tooltip:"Insert/edit media",cmd:"mceMedia",stateSelector:["img[data-mce-object]","span[data-mce-object]","div[data-ephox-embed-iri]"]}),e.addMenuItem("media",{icon:"media",text:"Media",cmd:"mceMedia",context:"insert",prependToContext:!0})},We={register:ze};function Ve(){}e.add("media",function(e){return Pe.register(e),We.register(e),Le.setup(e),Be.setup(e),je.setup(e),Ce.get(e)})})()})()},"3aea":function(e,t,n){n("3699")},"3b47":function(e,t){(function(){(function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=function(e){return function(){return e}};function n(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.concat(n);return e.apply(null,o)}}var r=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return!e.apply(null,t)}},o=t(!1),i=t(!0),a=o,c=i,u=function(){return l},l=function(){var e=function(e){return e.isNone()},n=function(e){return e()},r=function(e){return e},o=function(){},i=function(){return null},l=function(){},s={fold:function(e,t){return e()},is:a,isSome:a,isNone:c,getOr:r,getOrThunk:n,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:i,getOrUndefined:l,or:r,orThunk:n,map:u,ap:u,each:o,bind:u,flatten:u,exists:a,forall:c,filter:u,equals:e,equals_:e,toArray:function(){return[]},toString:t("none()")};return Object.freeze&&Object.freeze(s),s}(),s=function(e){var t=function(){return e},n=function(){return i},r=function(t){return s(t(e))},o=function(t){return t(e)},i={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:c,isNone:a,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:r,ap:function(t){return t.fold(u,function(t){return s(t(e))})},each:function(t){t(e)},bind:o,flatten:t,exists:o,forall:o,filter:function(t){return t(e)?i:l},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(a,function(t){return n(e,t)})},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return i},f=function(e){return null===e||void 0===e?l:s(e)},d={some:s,none:u,from:f},m=function(e){if(null===e)return"null";var t=typeof e;return"object"===t&&Array.prototype.isPrototypeOf(e)?"array":"object"===t&&String.prototype.isPrototypeOf(e)?"string":t},g=function(e){return function(t){return m(t)===e}},p=g("function"),h=function(){var e=Array.prototype.indexOf,t=function(t,n){return e.call(t,n)},n=function(e,t){return x(e,t)};return void 0===e?n:t}(),v=function(e,t){return h(e,t)>-1},y=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o,e)}return r},b=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r,e)&&n.push(i)}return n},w=function(e,t){for(var n=0,r=e.length;n<r;n++){var o=e[n];if(t(o,n,e))return d.some(o)}return d.none()},x=function(e,t){for(var n=0,r=e.length;n<r;++n)if(e[n]===t)return n;return-1},T=Array.prototype.slice,k=(p(Array.from)&&Array.from,tinymce.util.Tools.resolve("tinymce.util.I18n")),C=tinymce.util.Tools.resolve("tinymce.Env"),S=C.mac?"⌘":"Ctrl",P=C.mac?"Ctrl + Alt":"Shift + Alt",D=[{shortcut:S+" + B",action:"Bold"},{shortcut:S+" + I",action:"Italic"},{shortcut:S+" + U",action:"Underline"},{shortcut:S+" + A",action:"Select all"},{shortcut:S+" + Y or "+S+" + Shift + Z",action:"Redo"},{shortcut:S+" + Z",action:"Undo"},{shortcut:P+" + 1",action:"Header 1"},{shortcut:P+" + 2",action:"Header 2"},{shortcut:P+" + 3",action:"Header 3"},{shortcut:P+" + 4",action:"Header 4"},{shortcut:P+" + 5",action:"Header 5"},{shortcut:P+" + 6",action:"Header 6"},{shortcut:P+" + 7",action:"Paragraph"},{shortcut:P+" + 8",action:"Div"},{shortcut:P+" + 9",action:"Address"},{shortcut:"Alt + F9",action:"Focus to menubar"},{shortcut:"Alt + F10",action:"Focus to toolbar"},{shortcut:"Alt + F11",action:"Focus to element path"},{shortcut:"Ctrl + F9",action:"Focus to contextual toolbar"},{shortcut:S+" + K",action:"Insert link (if link plugin activated)"},{shortcut:S+" + S",action:"Save (if save plugin activated)"},{shortcut:S+" + F",action:"Find (if searchreplace plugin activated)"}],I={shortcuts:D},_=function(){var e=function(e){return'aria-label="Action: '+e.action+", Shortcut: "+e.shortcut.replace(/Ctrl/g,"Control")+'"'},t=y(I.shortcuts,function(t){return'<tr data-mce-tabstop="1" tabindex="-1" '+e(t)+"><td>"+k.translate(t.action)+"</td><td>"+t.shortcut+"</td></tr>"}).join("");return{title:"Handy Shortcuts",type:"container",style:"overflow-y: auto; overflow-x: hidden; max-height: 250px",items:[{type:"container",html:'<div><table class="mce-table-striped"><thead><th>'+k.translate("Action")+"</th><th>"+k.translate("Shortcut")+"</th></thead>"+t+"</table></div>"}]}},N={makeTab:_},M=Object.keys,E=function(e,t){var n=function(e){var t=typeof e;return"string"===t||"number"===t};return e.replace(/\$\{([^{}]*)\}/g,function(e,r){var o=t[r];return n(o)?o.toString():e})},A=[{key:"advlist",name:"Advanced List"},{key:"anchor",name:"Anchor"},{key:"autolink",name:"Autolink"},{key:"autoresize",name:"Autoresize"},{key:"autosave",name:"Autosave"},{key:"bbcode",name:"BBCode"},{key:"charmap",name:"Character Map"},{key:"code",name:"Code"},{key:"codesample",name:"Code Sample"},{key:"colorpicker",name:"Color Picker"},{key:"compat3x",name:"3.x Compatibility"},{key:"contextmenu",name:"Context Menu"},{key:"directionality",name:"Directionality"},{key:"emoticons",name:"Emoticons"},{key:"fullpage",name:"Full Page"},{key:"fullscreen",name:"Full Screen"},{key:"help",name:"Help"},{key:"hr",name:"Horizontal Rule"},{key:"image",name:"Image"},{key:"imagetools",name:"Image Tools"},{key:"importcss",name:"Import CSS"},{key:"insertdatetime",name:"Insert Date/Time"},{key:"legacyoutput",name:"Legacy Output"},{key:"link",name:"Link"},{key:"lists",name:"Lists"},{key:"media",name:"Media"},{key:"nonbreaking",name:"Nonbreaking"},{key:"noneditable",name:"Noneditable"},{key:"pagebreak",name:"Page Break"},{key:"paste",name:"Paste"},{key:"preview",name:"Preview"},{key:"print",name:"Print"},{key:"save",name:"Save"},{key:"searchreplace",name:"Search and Replace"},{key:"spellchecker",name:"Spell Checker"},{key:"tabfocus",name:"Tab Focus"},{key:"table",name:"Table"},{key:"template",name:"Template"},{key:"textcolor",name:"Text Color"},{key:"textpattern",name:"Text Pattern"},{key:"toc",name:"Table of Contents"},{key:"visualblocks",name:"Visual Blocks"},{key:"visualchars",name:"Visual Characters"},{key:"wordcount",name:"Word Count"}],O={urls:A},R=n(E,'<a href="${url}" target="_blank" rel="noopener">${name}</a>'),F=function(e,t){return w(O.urls,function(e){return e.key===t}).fold(function(){var n=e.plugins[t].getMetadata;return"function"===typeof n?R(n()):t},function(e){return R({name:e.name,url:"https://www.tinymce.com/docs/plugins/"+e.key})})},B=function(e){var t=M(e.plugins);return void 0===e.settings.forced_plugins?t:b(t,r(n(v,e.settings.forced_plugins)))},H=function(e){var t=B(e),n=y(t,function(t){return"<li>"+F(e,t)+"</li>"}),r=n.length,o=n.join("");return"<p><b>"+k.translate(["Plugins installed ({0}):",r])+"</b></p><ul>"+o+"</ul>"},L=function(e){return{type:"container",html:'<div style="overflow-y: auto; overflow-x: hidden; max-height: 230px; height: 230px;" data-mce-tabstop="1" tabindex="-1">'+H(e)+"</div>",flex:1}},U=function(){return{type:"container",html:'<div style="padding: 10px; background: #e3e7f4; height: 100%;" data-mce-tabstop="1" tabindex="-1"><p><b>'+k.translate("Premium plugins:")+'</b></p><ul><li>PowerPaste</li><li>Spell Checker Pro</li><li>Accessibility Checker</li><li>Advanced Code Editor</li><li>Enhanced Media Embed</li><li>Link Checker</li></ul><br /><p style="float: right;"><a href="https://www.tinymce.com/pricing/?utm_campaign=editor_referral&utm_medium=help_dialog&utm_source=tinymce" target="_blank">'+k.translate("Learn more...")+"</a></p></div>",flex:1}},j=function(e){return{title:"Plugins",type:"container",style:"overflow-y: auto; overflow-x: hidden;",layout:"flex",padding:10,spacing:10,items:[L(e),U()]}},z={makeTab:j},W=tinymce.util.Tools.resolve("tinymce.EditorManager"),V=function(e,t){return 0===e.indexOf("@")?"X.X.X":e+"."+t},G=function(){var e=V(W.majorVersion,W.minorVersion),t='<a href="https://www.tinymce.com/docs/changelog/?utm_campaign=editor_referral&utm_medium=help_dialog&utm_source=tinymce" target="_blank">TinyMCE '+e+"</a>";return[{type:"label",html:k.translate(["You are using {0}",t])},{type:"spacer",flex:1},{text:"Close",onclick:function(){this.parent().parent().close()}}]},$={makeRow:G},q=function(e,t){return function(){e.windowManager.open({title:"Help",bodyType:"tabpanel",layout:"flex",body:[N.makeTab(),z.makeTab(e)],buttons:$.makeRow(),onPostRender:function(){var e=this.getEl("title");e.innerHTML='<img src="'+t+'/img/logo.png" alt="TinyMCE Logo" style="display: inline-block; width: 200px; height: 50px">'}})}},Y={open:q},J=function(e,t){e.addCommand("mceHelp",Y.open(e,t))},X={register:J},K=function(e,t){e.addButton("help",{icon:"help",onclick:Y.open(e,t)}),e.addMenuItem("help",{text:"Help",icon:"help",context:"help",onclick:Y.open(e,t)})},Z={register:K};function Q(){}e.add("help",function(e,t){Z.register(e,t),X.register(e,t),e.shortcuts.add("Alt+0","Open help dialog","mceHelp")})})()})()},"4bd0":function(e,t,n){n("a376")},"4bdc":function(e,t){(function(){(function(){"use strict";var e=function(t){var n=t,r=function(){return n},o=function(e){n=e},i=function(){return e(r())};return{get:r,set:o,clone:i}},t=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=function(e,t){e.fire("VisualBlocks",{state:t})},r={fireVisualBlocks:n},o=function(e){return e.getParam("visualblocks_default_state",!1)},i=function(e){return e.settings.visualblocks_content_css},a={isEnabledByDefault:o,getContentCss:i},c=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),u=tinymce.util.Tools.resolve("tinymce.util.Tools"),l=c.DOM.uniqueId(),s=function(e,t){var n=u.toArray(e.getElementsByTagName("link")),r=u.grep(n,function(e){return e.id===l});if(0===r.length){var o=c.DOM.create("link",{id:l,rel:"stylesheet",href:t});e.getElementsByTagName("head")[0].appendChild(o)}},f={load:s},d=function(e,t,n){var o=e.dom,i=a.getContentCss(e);f.load(e.getDoc(),i||t+"/css/visualblocks.css"),o.toggleClass(e.getBody(),"mce-visualblocks"),n.set(!n.get()),r.fireVisualBlocks(e,n.get())},m={toggleVisualBlocks:d},g=function(e,t,n){e.addCommand("mceVisualBlocks",function(){m.toggleVisualBlocks(e,t,n)})},p={register:g},h=function(e,t,n){e.on("PreviewFormats AfterPreviewFormats",function(t){n.get()&&e.dom.toggleClass(e.getBody(),"mce-visualblocks","afterpreviewformats"===t.type)}),e.on("init",function(){a.isEnabledByDefault(e)&&m.toggleVisualBlocks(e,t,n)}),e.on("remove",function(){e.dom.removeClass(e.getBody(),"mce-visualblocks")})},v={setup:h},y=function(e,t){return function(n){var r=n.control;r.active(t.get()),e.on("VisualBlocks",function(e){r.active(e.state)})}},b=function(e,t){e.addButton("visualblocks",{active:!1,title:"Show blocks",cmd:"mceVisualBlocks",onPostRender:y(e,t)}),e.addMenuItem("visualblocks",{text:"Show blocks",cmd:"mceVisualBlocks",onPostRender:y(e,t),selectable:!0,context:"view",prependToContext:!0})},w={register:b};function x(){}t.add("visualblocks",function(t,n){var r=e(!1);p.register(t,n,r),w.register(t,r),v.setup(t,n,r)})})()})()},"62e5":function(e,t,n){n("2519")},6957:function(e,t,n){n("75b8")},"69a4":function(e,t){(function(){(function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.Env"),n=function(e){return parseInt(e.getParam("plugin_preview_width","650"),10)},r=function(e){return parseInt(e.getParam("plugin_preview_height","500"),10)},o=function(e){return e.getParam("content_style","")},i={getPreviewDialogWidth:n,getPreviewDialogHeight:r,getContentStyle:o},a=tinymce.util.Tools.resolve("tinymce.util.Tools"),c=function(e){var t,n="",r=e.dom.encode,o=i.getContentStyle(e);n+='<base href="'+r(e.documentBaseURI.getURI())+'">',o&&(n+='<style type="text/css">'+o+"</style>"),a.each(e.contentCSS,function(t){n+='<link type="text/css" rel="stylesheet" href="'+r(e.documentBaseURI.toAbsolute(t))+'">'});var c=e.settings.body_id||"tinymce";-1!==c.indexOf("=")&&(c=e.getParam("body_id","","hash"),c=c[e.id]||c);var u=e.settings.body_class||"";-1!==u.indexOf("=")&&(u=e.getParam("body_class","","hash"),u=u[e.id]||"");var l='<script>document.addEventListener && document.addEventListener("click", function(e) {for (var elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A") {e.preventDefault();}}}, false);<\/script> ',s=e.settings.directionality?' dir="'+e.settings.directionality+'"':"";return t="<!DOCTYPE html><html><head>"+n+'</head><body id="'+r(c)+'" class="mce-content-body '+r(u)+'"'+r(s)+">"+e.getContent()+l+"</body></html>",t},u=function(e,t,n){var r=c(e);if(n)t.src="data:text/html;charset=utf-8,"+encodeURIComponent(r);else{var o=t.contentWindow.document;o.open(),o.write(r),o.close()}},l={getPreviewHtml:c,injectIframeContent:u},s=function(e){var n=!t.ie,r='<iframe src="" frameborder="0"'+(n?' sandbox="allow-scripts"':"")+"></iframe>",o=i.getPreviewDialogWidth(e),a=i.getPreviewDialogHeight(e);e.windowManager.open({title:"Preview",width:o,height:a,html:r,buttons:{text:"Close",onclick:function(e){e.control.parent().parent().close()}},onPostRender:function(t){var r=t.control.getEl("body").firstChild;l.injectIframeContent(e,r,n)}})},f={open:s},d=function(e){e.addCommand("mcePreview",function(){f.open(e)})},m={register:d},g=function(e){e.addButton("preview",{title:"Preview",cmd:"mcePreview"}),e.addMenuItem("preview",{text:"Preview",cmd:"mcePreview",context:"view"})},p={register:g};function h(){}e.add("preview",function(e){m.register(e),p.register(e)})})()})()},"69e4":function(e,t,n){n("d169")},"6b68":function(e,t){(function(){(function(){"use strict";var e=function(t){var n=t,r=function(){return n},o=function(e){n=e},i=function(){return e(r())};return{get:r,set:o,clone:i}},t=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=tinymce.util.Tools.resolve("tinymce.util.Tools"),r=tinymce.util.Tools.resolve("tinymce.html.DomParser"),o=tinymce.util.Tools.resolve("tinymce.html.Node"),i=tinymce.util.Tools.resolve("tinymce.html.Serializer"),a=function(e){return e.getParam("fullpage_hide_in_source_view")},c=function(e){return e.getParam("fullpage_default_xml_pi")},u=function(e){return e.getParam("fullpage_default_encoding")},l=function(e){return e.getParam("fullpage_default_font_family")},s=function(e){return e.getParam("fullpage_default_font_size")},f=function(e){return e.getParam("fullpage_default_text_color")},d=function(e){return e.getParam("fullpage_default_title")},m=function(e){return e.getParam("fullpage_default_doctype","<!DOCTYPE html>")},g={shouldHideInSourceView:a,getDefaultXmlPi:c,getDefaultEncoding:u,getDefaultFontFamily:l,getDefaultFontSize:s,getDefaultTextColor:f,getDefaultTitle:d,getDefaultDocType:m},p=function(e){return r({validate:!1,root_name:"#document"}).parse(e)},h=function(e,t){var r,o,i=p(t),a={};function c(e,t){var n=e.attr(t);return n||""}return a.fontface=g.getDefaultFontFamily(e),a.fontsize=g.getDefaultFontSize(e),r=i.firstChild,7===r.type&&(a.xml_pi=!0,o=/encoding="([^"]+)"/.exec(r.value),o&&(a.docencoding=o[1])),r=i.getAll("#doctype")[0],r&&(a.doctype="<!DOCTYPE"+r.value+">"),r=i.getAll("title")[0],r&&r.firstChild&&(a.title=r.firstChild.value),n.each(i.getAll("meta"),function(e){var t,n=e.attr("name"),r=e.attr("http-equiv");n?a[n.toLowerCase()]=e.attr("content"):"Content-Type"===r&&(t=/charset\s*=\s*(.*)\s*/gi.exec(e.attr("content")),t&&(a.docencoding=t[1]))}),r=i.getAll("html")[0],r&&(a.langcode=c(r,"lang")||c(r,"xml:lang")),a.stylesheets=[],n.each(i.getAll("link"),function(e){"stylesheet"===e.attr("rel")&&a.stylesheets.push(e.attr("href"))}),r=i.getAll("body")[0],r&&(a.langdir=c(r,"dir"),a.style=c(r,"style"),a.visited_color=c(r,"vlink"),a.link_color=c(r,"link"),a.active_color=c(r,"alink")),a},v=function(e,t,r){var a,c,u,l,s,f=e.dom;function d(e,t,n){e.attr(t,n||void 0)}function m(e){c.firstChild?c.insert(e,c.firstChild):c.append(e)}a=p(r),c=a.getAll("head")[0],c||(l=a.getAll("html")[0],c=new o("head",1),l.firstChild?l.insert(c,l.firstChild,!0):l.append(c)),l=a.firstChild,t.xml_pi?(s='version="1.0"',t.docencoding&&(s+=' encoding="'+t.docencoding+'"'),7!==l.type&&(l=new o("xml",7),a.insert(l,a.firstChild,!0)),l.value=s):l&&7===l.type&&l.remove(),l=a.getAll("#doctype")[0],t.doctype?(l||(l=new o("#doctype",10),t.xml_pi?a.insert(l,a.firstChild):m(l)),l.value=t.doctype.substring(9,t.doctype.length-1)):l&&l.remove(),l=null,n.each(a.getAll("meta"),function(e){"Content-Type"===e.attr("http-equiv")&&(l=e)}),t.docencoding?(l||(l=new o("meta",1),l.attr("http-equiv","Content-Type"),l.shortEnded=!0,m(l)),l.attr("content","text/html; charset="+t.docencoding)):l&&l.remove(),l=a.getAll("title")[0],t.title?(l?l.empty():(l=new o("title",1),m(l)),l.append(new o("#text",3)).value=t.title):l&&l.remove(),n.each("keywords,description,author,copyright,robots".split(","),function(e){var n,r,i=a.getAll("meta"),c=t[e];for(n=0;n<i.length;n++)if(r=i[n],r.attr("name")===e)return void(c?r.attr("content",c):r.remove());c&&(l=new o("meta",1),l.attr("name",e),l.attr("content",c),l.shortEnded=!0,m(l))});var g={};return n.each(a.getAll("link"),function(e){"stylesheet"===e.attr("rel")&&(g[e.attr("href")]=e)}),n.each(t.stylesheets,function(e){g[e]||(l=new o("link",1),l.attr({rel:"stylesheet",text:"text/css",href:e}),l.shortEnded=!0,m(l)),delete g[e]}),n.each(g,function(e){e.remove()}),l=a.getAll("body")[0],l&&(d(l,"dir",t.langdir),d(l,"style",t.style),d(l,"vlink",t.visited_color),d(l,"link",t.link_color),d(l,"alink",t.active_color),f.setAttribs(e.getBody(),{style:t.style,dir:t.dir,vLink:t.visited_color,link:t.link_color,aLink:t.active_color})),l=a.getAll("html")[0],l&&(d(l,"lang",t.langcode),d(l,"xml:lang",t.langcode)),c.firstChild||c.remove(),u=i({validate:!1,indent:!0,apply_source_formatting:!0,indent_before:"head,html,body,meta,title,script,link,style",indent_after:"head,html,body,meta,title,script,link,style"}).serialize(a),u.substring(0,u.indexOf("</body>"))},y={parseHeader:p,htmlToData:h,dataToHtml:v},b=function(e,t){var r=y.htmlToData(e,t.get());e.windowManager.open({title:"Document properties",data:r,defaults:{type:"textbox",size:40},body:[{name:"title",label:"Title"},{name:"keywords",label:"Keywords"},{name:"description",label:"Description"},{name:"robots",label:"Robots"},{name:"author",label:"Author"},{name:"docencoding",label:"Encoding"}],onSubmit:function(o){var i=y.dataToHtml(e,n.extend(r,o.data),t.get());t.set(i)}})},w={open:b},x=function(e,t){e.addCommand("mceFullPageProperties",function(){w.open(e,t)})},T={register:x},k=function(e,t){return n.each(e,function(e){t=t.replace(e,function(e){return"\x3c!--mce:protected "+escape(e)+"--\x3e"})}),t},C=function(e){return e.replace(/<!--mce:protected ([\s\S]*?)-->/g,function(e,t){return unescape(t)})},S={protectHtml:k,unprotectHtml:C},P=n.each,D=function(e){return e.replace(/<\/?[A-Z]+/g,function(e){return e.toLowerCase()})},I=function(e,t,r,o){var i,a,c,u,l,s="",f=e.dom;if(!o.selection&&(c=S.protectHtml(e.settings.protect,o.content),("raw"!==o.format||!t.get())&&(!o.source_view||!g.shouldHideInSourceView(e)))){0!==c.length||o.source_view||(c=n.trim(t.get())+"\n"+n.trim(c)+"\n"+n.trim(r.get())),c=c.replace(/<(\/?)BODY/gi,"<$1body"),i=c.indexOf("<body"),-1!==i?(i=c.indexOf(">",i),t.set(D(c.substring(0,i+1))),a=c.indexOf("</body",i),-1===a&&(a=c.length),o.content=n.trim(c.substring(i+1,a)),r.set(D(c.substring(a)))):(t.set(_(e)),r.set("\n</body>\n</html>")),u=y.parseHeader(t.get()),P(u.getAll("style"),function(e){e.firstChild&&(s+=e.firstChild.value)}),l=u.getAll("body")[0],l&&f.setAttribs(e.getBody(),{style:l.attr("style")||"",dir:l.attr("dir")||"",vLink:l.attr("vlink")||"",link:l.attr("link")||"",aLink:l.attr("alink")||""}),f.remove("fullpage_styles");var d=e.getDoc().getElementsByTagName("head")[0];s&&(f.add(d,"style",{id:"fullpage_styles"},s),l=f.get("fullpage_styles"),l.styleSheet&&(l.styleSheet.cssText=s));var m={};n.each(d.getElementsByTagName("link"),function(e){"stylesheet"===e.rel&&e.getAttribute("data-mce-fullpage")&&(m[e.href]=e)}),n.each(u.getAll("link"),function(e){var t=e.attr("href");if(!t)return!0;m[t]||"stylesheet"!==e.attr("rel")||f.add(d,"link",{rel:"stylesheet",text:"text/css",href:t,"data-mce-fullpage":"1"}),delete m[t]}),n.each(m,function(e){e.parentNode.removeChild(e)})}},_=function(e){var t,n="",r="";if(g.getDefaultXmlPi(e)){var o=g.getDefaultEncoding(e);n+='<?xml version="1.0" encoding="'+(o||"ISO-8859-1")+'" ?>\n'}return n+=g.getDefaultDocType(e),n+="\n<html>\n<head>\n",(t=g.getDefaultTitle(e))&&(n+="<title>"+t+"</title>\n"),(t=g.getDefaultEncoding(e))&&(n+='<meta http-equiv="Content-Type" content="text/html; charset='+t+'" />\n'),(t=g.getDefaultFontFamily(e))&&(r+="font-family: "+t+";"),(t=g.getDefaultFontSize(e))&&(r+="font-size: "+t+";"),(t=g.getDefaultTextColor(e))&&(r+="color: "+t+";"),n+="</head>\n<body"+(r?' style="'+r+'"':"")+">\n",n},N=function(e,t,r,o){o.selection||o.source_view&&g.shouldHideInSourceView(e)||(o.content=S.unprotectHtml(n.trim(t)+"\n"+n.trim(o.content)+"\n"+n.trim(r)))},M=function(e,t,n){e.on("BeforeSetContent",function(r){I(e,t,n,r)}),e.on("GetContent",function(r){N(e,t.get(),n.get(),r)})},E={setup:M},A=function(e){e.addButton("fullpage",{title:"Document properties",cmd:"mceFullPageProperties"}),e.addMenuItem("fullpage",{text:"Document properties",cmd:"mceFullPageProperties",context:"file"})},O={register:A};function R(){}t.add("fullpage",function(t){var n=e(""),r=e("");T.register(t,n),O.register(t),E.setup(t,n,r)})})()})()},"75b8":function(e,t){(function(){(function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),n=tinymce.util.Tools.resolve("tinymce.util.Tools"),r=function(e){return e.getParam("save_enablewhendirty",!0)},o=function(e){return!!e.getParam("save_onsavecallback")},i=function(e){return!!e.getParam("save_oncancelcallback")},a={enableWhenDirty:r,hasOnSaveCallback:o,hasOnCancelCallback:i},c=function(e,t){e.notificationManager.open({text:e.translate(t),type:"error"})},u=function(e){var n;if(n=t.DOM.getParent(e.id,"form"),!a.enableWhenDirty(e)||e.isDirty()){if(e.save(),a.hasOnSaveCallback(e))return e.execCallback("save_onsavecallback",e),void e.nodeChanged();n?(e.setDirty(!1),n.onsubmit&&!n.onsubmit()||("function"===typeof n.submit?n.submit():c(e,"Error: Form submit field collision.")),e.nodeChanged()):c(e,"Error: No form element found.")}},l=function(e){var t=n.trim(e.startContent);a.hasOnCancelCallback(e)?e.execCallback("save_oncancelcallback",e):(e.setContent(t),e.undoManager.clear(),e.nodeChanged())},s={save:u,cancel:l},f=function(e){e.addCommand("mceSave",function(){s.save(e)}),e.addCommand("mceCancel",function(){s.cancel(e)})},d={register:f},m=function(e){return function(t){var n=t.control;e.on("nodeChange dirty",function(){n.disabled(a.enableWhenDirty(e)&&!e.isDirty())})}},g=function(e){e.addButton("save",{icon:"save",text:"Save",cmd:"mceSave",disabled:!0,onPostRender:m(e)}),e.addButton("cancel",{text:"Cancel",icon:!1,cmd:"mceCancel",disabled:!0,onPostRender:m(e)}),e.addShortcut("Meta+S","","mceSave")},p={register:g};function h(){}e.add("save",function(e){p.register(e),d.register(e)})})()})()},"7c4f":function(e,t){(function(){(function(){"use strict";var e=function(t){var n=t,r=function(){return n},o=function(e){n=e},i=function(){return e(r())};return{get:r,set:o,clone:i}},t=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=function(e){return!(!/(^|[ ,])powerpaste([, ]|$)/.test(e.settings.plugins)||!t.get("powerpaste"))&&("undefined"!==typeof window.console&&window.console.log&&window.console.log("PowerPaste is incompatible with Paste plugin! Remove 'paste' from the 'plugins' option."),!0)},r={hasProPlugin:n},o=function(e,t){return{clipboard:e,quirks:t}},i={get:o},a=function(e,t,n,r){return e.fire("PastePreProcess",{content:t,internal:n,wordContent:r})},c=function(e,t,n,r){return e.fire("PastePostProcess",{node:t,internal:n,wordContent:r})},u=function(e,t){return e.fire("PastePlainTextToggle",{state:t})},l=function(e,t){return e.fire("paste",{ieFake:t})},s={firePastePreProcess:a,firePastePostProcess:c,firePastePlainTextToggle:u,firePaste:l},f=function(e){return e.getParam("paste_plaintext_inform",!0)},d=function(e){return e.getParam("paste_block_drop",!1)},m=function(e){return e.getParam("paste_data_images",!1)},g=function(e){return e.getParam("paste_filter_drop",!0)},p=function(e){return e.getParam("paste_preprocess")},h=function(e){return e.getParam("paste_postprocess")},v=function(e){return e.getParam("paste_webkit_styles")},y=function(e){return e.getParam("paste_remove_styles_if_webkit",!0)},b=function(e){return e.getParam("paste_merge_formats",!0)},w=function(e){return e.getParam("smart_paste",!0)},x=function(e){return e.getParam("paste_as_text",!1)},T=function(e){return e.getParam("paste_retain_style_properties")},k=function(e){var t="-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody";return e.getParam("paste_word_valid_elements",t)},C=function(e){return e.getParam("paste_convert_word_fake_lists",!0)},S=function(e){return e.getParam("paste_enable_default_filters",!0)},P={shouldPlainTextInform:f,shouldBlockDrop:d,shouldPasteDataImages:m,shouldFilterDrop:g,getPreProcess:p,getPostProcess:h,getWebkitStyles:v,shouldRemoveWebKitStyles:y,shouldMergeFormats:b,isSmartPasteEnabled:w,isPasteAsTextEnabled:x,getRetainStyleProps:T,getWordValidElements:k,shouldConvertWordFakeLists:C,shouldUseDefaultFilters:S},D=function(e,t){return!1===t.get()&&P.shouldPlainTextInform(e)},I=function(e,t){e.notificationManager.open({text:e.translate(t),type:"info"})},_=function(e,t,n){"text"===t.pasteFormat.get()?(t.pasteFormat.set("html"),s.firePastePlainTextToggle(e,!1)):(t.pasteFormat.set("text"),s.firePastePlainTextToggle(e,!0),D(e,n)&&(I(e,"Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off."),n.set(!0))),e.focus()},N={togglePlainTextPaste:_},M=function(e,t,n){e.addCommand("mceTogglePlainTextPaste",function(){N.togglePlainTextPaste(e,t,n)}),e.addCommand("mceInsertClipboardContent",function(e,n){n.content&&t.pasteHtml(n.content,n.internal),n.text&&t.pasteText(n.text)})},E={register:M},A=tinymce.util.Tools.resolve("tinymce.Env"),O=tinymce.util.Tools.resolve("tinymce.util.Delay"),R=tinymce.util.Tools.resolve("tinymce.util.Tools"),F=tinymce.util.Tools.resolve("tinymce.util.VK"),B="x-tinymce/html",H="\x3c!-- "+B+" --\x3e",L=function(e){return H+e},U=function(e){return e.replace(H,"")},j=function(e){return-1!==e.indexOf(H)},z={mark:L,unmark:U,isMarked:j,internalHtmlMime:function(){return B}},W=tinymce.util.Tools.resolve("tinymce.html.Entities"),V=function(e){return!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(e)},G=function(e){return e.replace(/\r?\n/g,"<br>")},$=function(e,t){var n,r=[],o="<"+e;if("object"===typeof t){for(n in t)t.hasOwnProperty(n)&&r.push(n+'="'+W.encodeAllRaw(t[n])+'"');r.length&&(o+=" "+r.join(" "))}return o+">"},q=function(e,t,n){var r=e.split(/\n\n/),o=$(t,n),i="</"+t+">",a=R.map(r,function(e){return e.split(/\n/).join("<br />")}),c=function(e){return o+e+i};return 1===a.length?a[0]:R.map(a,c).join("")},Y=function(e,t,n){return t?q(e,t,n):G(e)},J={isPlainText:V,convert:Y,toBRs:G,toBlockElements:q},X=tinymce.util.Tools.resolve("tinymce.html.DomParser"),K=tinymce.util.Tools.resolve("tinymce.html.Node"),Z=tinymce.util.Tools.resolve("tinymce.html.Schema"),Q=tinymce.util.Tools.resolve("tinymce.html.Serializer");function ee(e,t){return R.each(t,function(t){e=t.constructor===RegExp?e.replace(t,""):e.replace(t[0],t[1])}),e}function te(e){var t=Z(),n=X({},t),r="",o=t.getShortEndedElements(),i=R.makeMap("script noscript style textarea video audio iframe object"," "),a=t.getBlockElements();function c(e){var t=e.name,n=e;if("br"!==t){if("wbr"!==t)if(o[t]&&(r+=" "),i[t])r+=" ";else{if(3===e.type&&(r+=e.value),!e.shortEnded&&(e=e.firstChild))do{c(e)}while(e=e.next);a[t]&&n.next&&(r+="\n","p"===t&&(r+="\n"))}}else r+="\n"}return e=ee(e,[/<!\[[^\]]+\]>/g]),c(n.parse(e)),r}function ne(e){function t(e,t,n){return t||n?" ":" "}return e=ee(e,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,t],/<br class="Apple-interchange-newline">/g,/<br>$/i]),e}function re(e){var t=0;return function(){return e+t++}}var oe=function(){return-1!==navigator.userAgent.indexOf(" Edge/")},ie={filter:ee,innerText:te,trimHtml:ne,createIdGenerator:re,isMsEdge:oe};function ae(e){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(e)||/class="OutlineElement/.test(e)||/id="?docs\-internal\-guid\-/.test(e)}function ce(e){var t,n;return n=[/^[IVXLMCD]{1,2}\.[ \u00a0]/,/^[ivxlmcd]{1,2}\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/],e=e.replace(/^[\u00a0 ]+/,""),R.each(n,function(n){if(n.test(e))return t=!0,!1}),t}function ue(e){return/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(e)}function le(e){var t,n,r=1;function o(e){var t="";if(3===e.type)return e.value;if(e=e.firstChild)do{t+=o(e)}while(e=e.next);return t}function i(e,t){if(3===e.type&&t.test(e.value))return e.value=e.value.replace(t,""),!1;if(e=e.firstChild)do{if(!i(e,t))return!1}while(e=e.next);return!0}function a(e){if(e._listIgnore)e.remove();else if(e=e.firstChild)do{a(e)}while(e=e.next)}function c(e,o,c){var u=e._listLevel||r;u!==r&&(u<r?t&&(t=t.parent.parent):(n=t,t=null)),t&&t.name===o?t.append(e):(n=n||t,t=new K(o,1),c>1&&t.attr("start",""+c),e.wrap(t)),e.name="li",u>r&&n&&n.lastChild.append(t),r=u,a(e),i(e,/^\u00a0+/),i(e,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/),i(e,/^\u00a0+/)}var u=[],l=e.firstChild;while("undefined"!==typeof l&&null!==l)if(u.push(l),l=l.walk(),null!==l)while("undefined"!==typeof l&&l.parent!==e)l=l.walk();for(var s=0;s<u.length;s++)if(e=u[s],"p"===e.name&&e.firstChild){var f=o(e);if(ue(f)){c(e,"ul");continue}if(ce(f)){var d=/([0-9]+)\./.exec(f),m=1;d&&(m=parseInt(d[1],10)),c(e,"ol",m);continue}if(e._listLevel){c(e,"ul",1);continue}t=null}else n=t,t=null}function se(e,t,n,r){var o,i={},a=e.dom.parseStyle(r);return R.each(a,function(a,c){switch(c){case"mso-list":o=/\w+ \w+([0-9]+)/i.exec(r),o&&(n._listLevel=parseInt(o[1],10)),/Ignore/i.test(a)&&n.firstChild&&(n._listIgnore=!0,n.firstChild._listIgnore=!0);break;case"horiz-align":c="text-align";break;case"vert-align":c="vertical-align";break;case"font-color":case"mso-foreground":c="color";break;case"mso-background":case"mso-highlight":c="background";break;case"font-weight":case"font-style":return void("normal"!==a&&(i[c]=a));case"mso-element":if(/^(comment|comment-list)$/i.test(a))return void n.remove();break}0!==c.indexOf("mso-comment")?0!==c.indexOf("mso-")&&("all"===P.getRetainStyleProps(e)||t&&t[c])&&(i[c]=a):n.remove()}),/(bold)/i.test(i["font-weight"])&&(delete i["font-weight"],n.wrap(new K("b",1))),/(italic)/i.test(i["font-style"])&&(delete i["font-style"],n.wrap(new K("i",1))),i=e.dom.serializeStyle(i,n.name),i||null}var fe=function(e,t){var n,r;n=P.getRetainStyleProps(e),n&&(r=R.makeMap(n.split(/[, ]/))),t=ie.filter(t,[/<br class="?Apple-interchange-newline"?>/gi,/<b[^>]+id="?docs-internal-[^>]*>/gi,/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi," "],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(e,t){return t.length>0?t.replace(/./," ").slice(Math.floor(t.length/2)).split("").join(" "):""}]]);var o=P.getWordValidElements(e),i=Z({valid_elements:o,valid_children:"-li[p]"});R.each(i.elements,function(e){e.attributes.class||(e.attributes.class={},e.attributesOrder.push("class")),e.attributes.style||(e.attributes.style={},e.attributesOrder.push("style"))});var a=X({},i);a.addAttributeFilter("style",function(t){var n,o=t.length;while(o--)n=t[o],n.attr("style",se(e,r,n,n.attr("style"))),"span"===n.name&&n.parent&&!n.attributes.length&&n.unwrap()}),a.addAttributeFilter("class",function(e){var t,n,r=e.length;while(r--)t=e[r],n=t.attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(n)&&t.remove(),t.attr("class",null)}),a.addNodeFilter("del",function(e){var t=e.length;while(t--)e[t].remove()}),a.addNodeFilter("a",function(e){var t,n,r,o=e.length;while(o--)if(t=e[o],n=t.attr("href"),r=t.attr("name"),n&&-1!==n.indexOf("#_msocom_"))t.remove();else if(n&&0===n.indexOf("file://")&&(n=n.split("#")[1],n&&(n="#"+n)),n||r){if(r&&!/^_?(?:toc|edn|ftn)/i.test(r)){t.unwrap();continue}t.attr({href:n,name:r})}else t.unwrap()});var c=a.parse(t);return P.shouldConvertWordFakeLists(e)&&le(c),t=Q({validate:e.settings.validate},i).serialize(c),t},de=function(e,t){return P.shouldUseDefaultFilters(e)?fe(e,t):t},me={preProcess:de,isWordContent:ae},ge=function(e,t){return{content:e,cancelled:t}},pe=function(e,t,n,r){var o=e.dom.create("div",{style:"display:none"},t),i=s.firePastePostProcess(e,o,n,r);return ge(i.node.innerHTML,i.isDefaultPrevented())},he=function(e,t,n,r){var o=s.firePastePreProcess(e,t,n,r);return e.hasEventListeners("PastePostProcess")&&!o.isDefaultPrevented()?pe(e,o.content,n,r):ge(o.content,o.isDefaultPrevented())},ve=function(e,t,n){var r=me.isWordContent(t),o=r?me.preProcess(e,t):t;return he(e,o,n,r)},ye={process:ve},be=function(e,t){var n=e.dom.create("body",{},t);return R.each(n.querySelectorAll("meta"),function(e){return e.parentNode.removeChild(e)}),n.innerHTML},we=function(e,t){return e.insertContent(be(e,t),{merge:P.shouldMergeFormats(e),paste:!0}),!0},xe=function(e){return/^https?:\/\/[\w\?\-\/+=.&%@~#]+$/i.test(e)},Te=function(e){return xe(e)&&/.(gif|jpe?g|png)$/.test(e)},ke=function(e,t,n){return e.undoManager.extra(function(){n(e,t)},function(){e.insertContent('<img src="'+t+'">')}),!0},Ce=function(e,t,n){return e.undoManager.extra(function(){n(e,t)},function(){e.execCommand("mceInsertLink",!1,t)}),!0},Se=function(e,t,n){return!(!1!==e.selection.isCollapsed()||!xe(t))&&Ce(e,t,n)},Pe=function(e,t,n){return!!Te(t)&&ke(e,t,n)},De=function(e,t){R.each([Se,Pe,we],function(n){return!0!==n(e,t,we)})},Ie=function(e,t){!1===P.isSmartPasteEnabled(e)?we(e,t):De(e,t)},_e={isImageUrl:Te,isAbsoluteUrl:xe,insertContent:Ie},Ne=function(e){return function(){return e}};function Me(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.concat(n);return e.apply(null,o)}}var Ee=Ne(!1),Ae=Ne(!0),Oe=Ee,Re=Ae,Fe=function(){return Be},Be=function(){var e=function(e){return e.isNone()},t=function(e){return e()},n=function(e){return e},r=function(){},o=function(){return null},i=function(){},a={fold:function(e,t){return e()},is:Oe,isSome:Oe,isNone:Re,getOr:n,getOrThunk:t,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:o,getOrUndefined:i,or:n,orThunk:t,map:Fe,ap:Fe,each:r,bind:Fe,flatten:Fe,exists:Oe,forall:Re,filter:Fe,equals:e,equals_:e,toArray:function(){return[]},toString:Ne("none()")};return Object.freeze&&Object.freeze(a),a}(),He=function(e){var t=function(){return e},n=function(){return i},r=function(t){return He(t(e))},o=function(t){return t(e)},i={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:Re,isNone:Oe,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:r,ap:function(t){return t.fold(Fe,function(t){return He(t(e))})},each:function(t){t(e)},bind:o,flatten:t,exists:o,forall:o,filter:function(t){return t(e)?i:Be},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(Oe,function(t){return n(e,t)})},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return i},Le=function(e){return null===e||void 0===e?Be:He(e)},Ue={some:He,none:Fe,from:Le},je=function(e){if(null===e)return"null";var t=typeof e;return"object"===t&&Array.prototype.isPrototypeOf(e)?"array":"object"===t&&String.prototype.isPrototypeOf(e)?"string":t},ze=function(e){return function(t){return je(t)===e}},We=ze("function"),Ve=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o,e)}return r},Ge=function(e,t){for(var n=0,r=e.length;n<r;n++){var o=e[n];t(o,n,e)}},$e=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r,e)&&n.push(i)}return n},qe=Array.prototype.slice,Ye=We(Array.from)?Array.from:function(e){return qe.call(e)},Je=function(e){var t=Ue.none(),n=[],r=function(e){return Je(function(t){o(function(n){t(e(n))})})},o=function(e){a()?u(e):n.push(e)},i=function(e){t=Ue.some(e),c(n),n=[]},a=function(){return t.isSome()},c=function(e){Ge(e,u)},u=function(e){t.each(function(t){setTimeout(function(){e(t)},0)})};return e(i),{get:o,map:r,isReady:a}},Xe=function(e){return Je(function(t){t(e)})},Ke={nu:Je,pure:Xe},Ze=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=this;setTimeout(function(){e.apply(r,t)},0)}},Qe=function(e){var t=function(t){e(Ze(t))},n=function(e){return Qe(function(n){t(function(t){var r=e(t);n(r)})})},r=function(e){return Qe(function(n){t(function(t){e(t).get(n)})})},o=function(e){return Qe(function(n){t(function(t){e.get(n)})})},i=function(){return Ke.nu(t)},a=function(){var e=null;return Qe(function(t){null===e&&(e=i()),e.get(t)})};return{map:n,bind:r,anonBind:o,toLazy:i,toCached:a,get:t}},et=function(e){return Qe(function(t){t(e)})},tt={nu:Qe,pure:et},nt=function(e,t){return t(function(t){var n=[],r=0,o=function(o){return function(i){n[o]=i,r++,r>=e.length&&t(n)}};0===e.length?t([]):Ge(e,function(e,t){e.get(o(t))})})},rt=function(e){return nt(e,tt.nu)},ot=function(e,t){var n=Ve(e,t);return rt(n)},it=function(e,t,n){var r=n||z.isMarked(t),o=ye.process(e,z.unmark(t),r);!1===o.cancelled&&_e.insertContent(e,o.content)},at=function(e,t){t=e.dom.encode(t).replace(/\r\n/g,"\n"),t=J.convert(t,e.settings.forced_root_block,e.settings.forced_root_block_attrs),it(e,t,!1)},ct=function(e){var t={},n="data:text/mce-internal,";if(e){if(e.getData){var r=e.getData("Text");r&&r.length>0&&-1===r.indexOf(n)&&(t["text/plain"]=r)}if(e.types)for(var o=0;o<e.types.length;o++){var i=e.types[o];try{t[i]=e.getData(i)}catch(a){t[i]=""}}}return t},ut=function(e,t){var n=ct(t.clipboardData||e.getDoc().dataTransfer);return ie.isMsEdge()?R.extend(n,{"text/html":""}):n},lt=function(e,t){return t in e&&e[t].length>0},st=function(e){return lt(e,"text/html")||lt(e,"text/plain")},ft=function(e){var t;return t=e.indexOf(","),-1!==t?e.substr(t+1):null},dt=function(e,t){return!e.images_dataimg_filter||e.images_dataimg_filter(t)},mt=function(e,t){var n=t.match(/([\s\S]+?)\.(?:jpeg|jpg|png|gif)$/i);return n?e.dom.encode(n[1]):null},gt=ie.createIdGenerator("mceclip"),pt=function(e,t){var n=ft(t.uri),r=gt(),o=e.settings.images_reuse_filename&&t.blob.name?mt(e,t.blob.name):r,i=new Image;if(i.src=t.uri,dt(e.settings,i)){var a=e.editorUpload.blobCache,c=void 0,u=void 0;u=a.findFirst(function(e){return e.base64()===n}),u?c=u:(c=a.create(r,t.blob,n,o),a.add(c)),it(e,'<img src="'+c.blobUri()+'">',!1)}else it(e,'<img src="'+t.uri+'">',!1)},ht=function(e){return"paste"===e.type},vt=function(e){return ot(e,function(e){return tt.nu(function(t){var n=e.getAsFile?e.getAsFile():e,r=new window.FileReader;r.onload=function(){t({blob:n,uri:r.result})},r.readAsDataURL(n)})})},yt=function(e){var t=e.items?Ve(Ye(e.items),function(e){return e.getAsFile()}):[],n=e.files?Ye(e.files):[],r=$e(t.length>0?t:n,function(e){return/^image\/(jpeg|png|gif|bmp)$/.test(e.type)});return r},bt=function(e,t,n){var r=ht(t)?t.clipboardData:t.dataTransfer;if(e.settings.paste_data_images&&r){var o=yt(r);if(o.length>0)return t.preventDefault(),vt(o).get(function(t){n&&e.selection.setRng(n),Ge(t,function(t){pt(e,t)})}),!0}return!1},wt=function(e){var t=e.clipboardData;return-1!==navigator.userAgent.indexOf("Android")&&t&&t.items&&0===t.items.length},xt=function(e){return F.metaKeyPressed(e)&&86===e.keyCode||e.shiftKey&&45===e.keyCode},Tt=function(e,t,n){var r,o=0;function i(n,r,o,i){var a,c;lt(n,"text/html")?a=n["text/html"]:(a=t.getHtml(),i=i||z.isMarked(a),t.isDefaultContent(a)&&(o=!0)),a=ie.trimHtml(a),t.remove(),c=!1===i&&J.isPlainText(a),a.length&&!c||(o=!0),o&&(a=lt(n,"text/plain")&&c?n["text/plain"]:ie.innerText(a)),t.isDefaultContent(a)?r||e.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."):o?at(e,a):it(e,a,i)}e.on("keydown",function(n){function i(e){xt(e)&&!e.isDefaultPrevented()&&t.remove()}if(xt(n)&&!n.isDefaultPrevented()){if(r=n.shiftKey&&86===n.keyCode,r&&A.webkit&&-1!==navigator.userAgent.indexOf("Version/"))return;if(n.stopImmediatePropagation(),o=(new Date).getTime(),A.ie&&r)return n.preventDefault(),void s.firePaste(e,!0);t.remove(),t.create(),e.once("keyup",i),e.once("paste",function(){e.off("keyup",i)})}});var a=function(){return t.getLastRng()||e.selection.getRng()};e.on("paste",function(c){var u=(new Date).getTime(),l=ut(e,c),s=(new Date).getTime()-u,f=(new Date).getTime()-o-s<1e3,d="text"===n.get()||r,m=lt(l,z.internalHtmlMime());r=!1,c.isDefaultPrevented()||wt(c)?t.remove():st(l)||!bt(e,c,a())?(f||c.preventDefault(),!A.ie||f&&!c.ieFake||lt(l,"text/html")||(t.create(),e.dom.bind(t.getEl(),"paste",function(e){e.stopPropagation()}),e.getDoc().execCommand("Paste",!1,null),l["text/html"]=t.getHtml()),lt(l,"text/html")?(c.preventDefault(),m||(m=z.isMarked(l["text/html"])),i(l,f,d,m)):O.setEditorTimeout(e,function(){i(l,f,d,m)},0)):t.remove()})},kt=function(e,t,n){var r;Tt(e,t,n),e.parser.addNodeFilter("img",function(t,n,o){var i=function(e){return e.data&&!0===e.data.paste},a=function(e){e.attr("data-mce-object")||r===A.transparentSrc||e.remove()},c=function(e){return 0===e.indexOf("webkit-fake-url")},u=function(e){return 0===e.indexOf("data:")};if(!e.settings.paste_data_images&&i(o)){var l=t.length;while(l--)r=t[l].attributes.map.src,r&&(c(r)?a(t[l]):!e.settings.allow_html_data_urls&&u(r)&&a(t[l]))}})},Ct=function(e){return A.ie&&e.inline?document.body:e.getBody()},St=function(e){return Ct(e)!==e.getBody()},Pt=function(e,t,n){St(e)&&e.dom.bind(t,"paste keyup",function(t){Ot(e,n)||e.fire("paste")})},Dt=function(e,t,n){var r,o=e.dom,i=e.getBody();t.set(e.selection.getRng()),r=e.dom.add(Ct(e),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},n),(A.ie||A.gecko)&&o.setStyle(r,"left","rtl"===o.getStyle(i,"direction",!0)?65535:-65535),o.bind(r,"beforedeactivate focusin focusout",function(e){e.stopPropagation()}),Pt(e,r,n),r.focus(),e.selection.select(r,!0)},It=function(e,t){if(_t(e)){var n=void 0,r=t.get();while(n=e.dom.get("mcepastebin"))e.dom.remove(n),e.dom.unbind(n);r&&e.selection.setRng(r)}t.set(null)},_t=function(e){return e.dom.get("mcepastebin")},Nt=function(e){var t,n,r,o,i,a=function(t,n){t.appendChild(n),e.dom.remove(n,!0)};for(n=R.grep(Ct(e).childNodes,function(e){return"mcepastebin"===e.id}),t=n.shift(),R.each(n,function(e){a(t,e)}),o=e.dom.select("div[id=mcepastebin]",t),r=o.length-1;r>=0;r--)i=e.dom.create("div"),t.insertBefore(i,o[r]),a(i,o[r]);return t?t.innerHTML:""},Mt=function(e){return e.get()},Et=function(e,t){return t===e},At=function(e){return e&&"mcepastebin"===e.id},Ot=function(e,t){var n=_t(e);return At(n)&&Et(t,n.innerHTML)},Rt=function(t){var n=e(null),r="%MCEPASTEBIN%";return{create:function(){return Dt(t,n,r)},remove:function(){return It(t,n)},getEl:function(){return _t(t)},getHtml:function(){return Nt(t)},getLastRng:function(){return Mt(n)},isDefault:function(){return Ot(t,r)},isDefaultContent:function(e){return Et(r,e)}}},Ft=function(e,t){var n=Rt(e);return e.on("preInit",function(){return kt(e,n,t)}),{pasteFormat:t,pasteHtml:function(t,n){return it(e,t,n)},pasteText:function(t){return at(e,t)},pasteImageData:function(t,n){return bt(e,t,n)},getDataTransferItems:ct,hasHtmlOrText:st,hasContentType:lt}},Bt=function(){},Ht=function(e){return!1===A.iOS&&void 0!==e&&"function"===typeof e.setData&&!0!==ie.isMsEdge()},Lt=function(e,t,n){if(!Ht(e))return!1;try{return e.clearData(),e.setData("text/html",t),e.setData("text/plain",n),e.setData(z.internalHtmlMime(),t),!0}catch(r){return!1}},Ut=function(e,t,n,r){Lt(e.clipboardData,t.html,t.text)?(e.preventDefault(),r()):n(t.html,r)},jt=function(e){return function(t,n){var r=z.mark(t),o=e.dom.create("div",{contenteditable:"false","data-mce-bogus":"all"}),i=e.dom.create("div",{contenteditable:"true"},r);e.dom.setStyles(o,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),o.appendChild(i),e.dom.add(e.getBody(),o);var a=e.selection.getRng();i.focus();var c=e.dom.createRng();c.selectNodeContents(i),e.selection.setRng(c),setTimeout(function(){e.selection.setRng(a),o.parentNode.removeChild(o),n()},0)}},zt=function(e){return{html:e.selection.getContent({contextual:!0}),text:e.selection.getContent({format:"text"})}},Wt=function(e){return!!e.dom.getParent(e.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",e.getBody())},Vt=function(e){return!e.selection.isCollapsed()||Wt(e)},Gt=function(e){return function(t){Vt(e)&&Ut(t,zt(e),jt(e),function(){setTimeout(function(){e.execCommand("Delete")},0)})}},$t=function(e){return function(t){Vt(e)&&Ut(t,zt(e),jt(e),Bt)}},qt=function(e){e.on("cut",Gt(e)),e.on("copy",$t(e))},Yt={register:qt},Jt=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),Xt=function(e,t){return Jt.getCaretRangeFromPoint(t.clientX,t.clientY,e.getDoc())},Kt=function(e){var t=e["text/plain"];return!!t&&0===t.indexOf("file://")},Zt=function(e,t){e.focus(),e.selection.setRng(t)},Qt=function(e,t,n){P.shouldBlockDrop(e)&&e.on("dragend dragover draggesture dragdrop drop drag",function(e){e.preventDefault(),e.stopPropagation()}),P.shouldPasteDataImages(e)||e.on("drop",function(e){var t=e.dataTransfer;t&&t.files&&t.files.length>0&&e.preventDefault()}),e.on("drop",function(r){var o,i;if(i=Xt(e,r),!r.isDefaultPrevented()&&!n.get()){o=t.getDataTransferItems(r.dataTransfer);var a=t.hasContentType(o,z.internalHtmlMime());if((t.hasHtmlOrText(o)&&!Kt(o)||!t.pasteImageData(r,i))&&i&&P.shouldFilterDrop(e)){var c=o["mce-internal"]||o["text/html"]||o["text/plain"];c&&(r.preventDefault(),O.setEditorTimeout(e,function(){e.undoManager.transact(function(){o["mce-internal"]&&e.execCommand("Delete"),Zt(e,i),c=ie.trimHtml(c),o["text/html"]?t.pasteHtml(c,a):t.pasteText(c)})}))}}}),e.on("dragstart",function(e){n.set(!0)}),e.on("dragover dragend",function(t){P.shouldPasteDataImages(e)&&!1===n.get()&&(t.preventDefault(),Zt(e,Xt(e,t))),"dragend"===t.type&&n.set(!1)})},en={setup:Qt},tn=function(e){var t=e.plugins.paste,n=P.getPreProcess(e);n&&e.on("PastePreProcess",function(e){n.call(t,t,e)});var r=P.getPostProcess(e);r&&e.on("PastePostProcess",function(e){r.call(t,t,e)})},nn={setup:tn};function rn(e,t){e.on("PastePreProcess",function(n){n.content=t(e,n.content,n.internal,n.wordContent)})}function on(e,t){e.on("PastePostProcess",function(n){t(e,n.node)})}function an(e,t){if(!me.isWordContent(t))return t;var n=[];R.each(e.schema.getBlockElements(),function(e,t){n.push(t)});var r=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+n.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");return t=ie.filter(t,[[r,"$1"]]),t=ie.filter(t,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]]),t}function cn(e,t,n,r){if(r||n)return t;var o,i=P.getWebkitStyles(e);if(!1===P.shouldRemoveWebKitStyles(e)||"all"===i)return t;if(i&&(o=i.split(/[, ]/)),o){var a=e.dom,c=e.selection.getNode();t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,function(e,t,n,r){var i=a.parseStyle(a.decode(n)),u={};if("none"===o)return t+r;for(var l=0;l<o.length;l++){var s=i[o[l]],f=a.getStyle(c,o[l],!0);/color/.test(o[l])&&(s=a.toHex(s),f=a.toHex(f)),f!==s&&(u[o[l]]=s)}return u=a.serializeStyle(u,"span"),u?t+' style="'+u+'"'+r:t+r})}else t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return t=t.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,function(e,t,n,r){return t+' style="'+n+'"'+r}),t}function un(e,t){e.$("a",t).find("font,u").each(function(t,n){e.dom.remove(n,!0)})}var ln=function(e){A.webkit&&rn(e,cn),A.ie&&(rn(e,an),on(e,un))},sn={setup:ln},fn=function(e,t,n){var r=n.control;r.active("text"===t.pasteFormat.get()),e.on("PastePlainTextToggle",function(e){r.active(e.state)})},dn=function(e,t){var n=Me(fn,e,t);e.addButton("pastetext",{active:!1,icon:"pastetext",tooltip:"Paste as text",cmd:"mceTogglePlainTextPaste",onPostRender:n}),e.addMenuItem("pastetext",{text:"Paste as text",selectable:!0,active:t.pasteFormat,cmd:"mceTogglePlainTextPaste",onPostRender:n})},mn={register:dn};function gn(){}t.add("paste",function(t){if(!1===r.hasProPlugin(t)){var n=e(!1),o=e(!1),a=e(P.isPasteAsTextEnabled(t)?"text":"html"),c=Ft(t,a),u=sn.setup(t);return mn.register(t,c),E.register(t,c,n),nn.setup(t),Yt.register(t),en.setup(t,c,o),i.get(c,u)}})})()})()},"840a":function(e,t,n){n("d4c3")},"855b":function(e,t,n){n("e2d6")},8863:function(e,t,n){n("9dd9")},"9dd9":function(e,t){(function(){(function(){"use strict";var e=function(t){var n=t,r=function(){return n},o=function(e){n=e},i=function(){return e(r())};return{get:r,set:o,clone:i}},t=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=tinymce.util.Tools.resolve("tinymce.util.Tools");function r(e,t){return c(document.createElement("canvas"),e,t)}function o(e){var t,n;return t=r(e.width,e.height),n=i(t),n.drawImage(e,0,0),t}function i(e){return e.getContext("2d")}function a(e){var t=null;try{t=e.getContext("webgl")||e.getContext("experimental-webgl")}catch(n){}return t||(t=null),t}function c(e,t,n){return e.width=t,e.height=n,e}var u={create:r,clone:o,resize:c,get2dContext:i,get3dContext:a};function l(e){return e.naturalWidth||e.width}function s(e){return e.naturalHeight||e.height}var f={getWidth:l,getHeight:s},d=function(){var e=function(e){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof e)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],l(e,n(i,this),n(a,this))},t=e.immediateFn||"function"===typeof window.setImmediate&&window.setImmediate||function(e){setTimeout(e,1)};function n(e,t){return function(){e.apply(t,arguments)}}var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function o(e){var n=this;null!==this._state?t(function(){var t=n._state?e.onFulfilled:e.onRejected;if(null!==t){var r;try{r=t(n._value)}catch(o){return void e.reject(o)}e.resolve(r)}else(n._state?e.resolve:e.reject)(n._value)}):this._deferreds.push(e)}function i(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"===typeof e||"function"===typeof e)){var t=e.then;if("function"===typeof t)return void l(n(t,e),n(i,this),n(a,this))}this._state=!0,this._value=e,c.call(this)}catch(r){a.call(this,r)}}function a(e){this._state=!1,this._value=e,c.call(this)}function c(){for(var e=0,t=this._deferreds.length;e<t;e++)o.call(this,this._deferreds[e]);this._deferreds=null}function u(e,t,n,r){this.onFulfilled="function"===typeof e?e:null,this.onRejected="function"===typeof t?t:null,this.resolve=n,this.reject=r}function l(e,t,n){var r=!1;try{e(function(e){r||(r=!0,t(e))},function(e){r||(r=!0,n(e))})}catch(o){if(r)return;r=!0,n(o)}}return e.prototype["catch"]=function(e){return this.then(null,e)},e.prototype.then=function(t,n){var r=this;return new e(function(e,i){o.call(r,new u(t,n,e,i))})},e.all=function(){var t=Array.prototype.slice.call(1===arguments.length&&r(arguments[0])?arguments[0]:arguments);return new e(function(e,n){if(0===t.length)return e([]);var r=t.length;function o(i,a){try{if(a&&("object"===typeof a||"function"===typeof a)){var c=a.then;if("function"===typeof c)return void c.call(a,function(e){o(i,e)},n)}t[i]=a,0===--r&&e(t)}catch(u){n(u)}}for(var i=0;i<t.length;i++)o(i,t[i])})},e.resolve=function(t){return t&&"object"===typeof t&&t.constructor===e?t:new e(function(e){e(t)})},e.reject=function(t){return new e(function(e,n){n(t)})},e.race=function(t){return new e(function(e,n){for(var r=0,o=t.length;r<o;r++)t[r].then(e,n)})},e},m=window.Promise?window.Promise:d(),g=function(e){return function(){return e}};function p(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=t.concat(n);return e.apply(null,o)}}var h=g(!1),v=g(!0),y=h,b=v,w=function(){return x},x=function(){var e=function(e){return e.isNone()},t=function(e){return e()},n=function(e){return e},r=function(){},o=function(){return null},i=function(){},a={fold:function(e,t){return e()},is:y,isSome:y,isNone:b,getOr:n,getOrThunk:t,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:o,getOrUndefined:i,or:n,orThunk:t,map:w,ap:w,each:r,bind:w,flatten:w,exists:y,forall:b,filter:w,equals:e,equals_:e,toArray:function(){return[]},toString:g("none()")};return Object.freeze&&Object.freeze(a),a}(),T=function(e){var t=function(){return e},n=function(){return i},r=function(t){return T(t(e))},o=function(t){return t(e)},i={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:b,isNone:y,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:r,ap:function(t){return t.fold(w,function(t){return T(t(e))})},each:function(t){t(e)},bind:o,flatten:t,exists:o,forall:o,filter:function(t){return t(e)?i:x},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(y,function(t){return n(e,t)})},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return i},k=function(e){return null===e||void 0===e?x:T(e)},C={some:T,none:w,from:k},S="undefined"!==typeof window?window:Function("return this;")(),P=function(e,t){for(var n=void 0!==t&&null!==t?t:S,r=0;r<e.length&&void 0!==n&&null!==n;++r)n=n[e[r]];return n},D=function(e,t){var n=e.split(".");return P(n,t)},I=function(e,t){return D(e,t)},_=function(e,t){var n=I(e,t);if(void 0===n||null===n)throw e+" not available on this browser";return n},N={getOrDie:_};function M(e,t){var n=N.getOrDie("Blob");return new n(e,t)}function E(){var e=N.getOrDie("FileReader");return new e}function A(e){var t=N.getOrDie("Uint8Array");return new t(e)}var O=function(e){var t=N.getOrDie("requestAnimationFrame");t(e)},R=function(e){var t=N.getOrDie("atob");return t(e)},F={atob:R,requestAnimationFrame:O};function B(e){var t=e.src;return 0===t.indexOf("data:")?j(t):L(t)}function H(e){return new m(function(t,n){var r=URL.createObjectURL(e),o=new Image,i=function(){o.removeEventListener("load",a),o.removeEventListener("error",c)};function a(){i(),t(o)}function c(){i(),n("Unable to load data of type "+e.type+": "+r)}o.addEventListener("load",a),o.addEventListener("error",c),o.src=r,o.complete&&a()})}function L(e){return new m(function(t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="blob",r.onload=function(){200==this.status&&t(this.response)},r.onerror=function(){var e=this,t=function(){var e=new Error("No access to download image");return e.code=18,e.name="SecurityError",e},r=function(){return new Error("Error "+e.status+" downloading image")};n(0===this.status?t():r())},r.send()})}function U(e){var t=e.split(","),n=/data:([^;]+)/.exec(t[0]);if(!n)return C.none();for(var r=n[1],o=t[1],i=1024,a=F.atob(o),c=a.length,u=Math.ceil(c/i),l=new Array(u),s=0;s<u;++s){for(var f=s*i,d=Math.min(f+i,c),m=new Array(d-f),g=f,p=0;g<d;++p,++g)m[p]=a[g].charCodeAt(0);l[s]=A(m)}return C.some(M(l,{type:r}))}function j(e){return new m(function(t,n){U(e).fold(function(){n("uri is not base64: "+e)},t)})}function z(e){return 0===e.indexOf("blob:")?L(e):0===e.indexOf("data:")?j(e):null}function W(e,t,n){return t=t||"image/png",HTMLCanvasElement.prototype.toBlob?new m(function(r){e.toBlob(function(e){r(e)},t,n)}):j(e.toDataURL(t,n))}function V(e,t,n){return t=t||"image/png",e.then(function(e){return e.toDataURL(t,n)})}function G(e){return H(e).then(function(e){var t,n;return J(e),n=u.create(f.getWidth(e),f.getHeight(e)),t=u.get2dContext(n),t.drawImage(e,0,0),n})}function $(e){return new m(function(t){var n=E();n.onloadend=function(){t(n.result)},n.readAsDataURL(e)})}function q(e){return new m(function(t){var n=E();n.onloadend=function(){t(n.result)},n.readAsArrayBuffer(e)})}function Y(e){return $(e).then(function(e){return e.split(",")[1]})}function J(e){URL.revokeObjectURL(e.src)}var X={blobToImage:H,imageToBlob:B,blobToArrayBuffer:q,blobToDataUri:$,blobToBase64:Y,dataUriToBlobSync:U,canvasToBlob:W,canvasToDataURL:V,blobToCanvas:G,uriToBlob:z},K=function(e){return X.blobToImage(e)},Z=function(e){return X.imageToBlob(e)},Q=function(e){return X.blobToDataUri(e)},ee=function(e){return X.blobToBase64(e)},te=function(e){return X.dataUriToBlobSync(e)},ne=function(e){return C.from(X.uriToBlob(e))},re={blobToImage:K,imageToBlob:Z,blobToDataUri:Q,blobToBase64:ee,dataUriToBlobSync:te,uriToBlob:ne};function oe(e,t,n){var r=t.type,o=g(r);function i(){return m.resolve(t)}function a(){return n}function c(){return n.split(",")[1]}function l(t,n){return e.then(function(e){return X.canvasToBlob(e,t,n)})}function s(t,n){return e.then(function(e){return X.canvasToDataURL(e,t,n)})}function f(e,t){return s(e,t).then(function(e){return e.split(",")[1]})}function d(){return e.then(u.clone)}return{getType:o,toBlob:i,toDataURL:a,toBase64:c,toAdjustedBlob:l,toAdjustedDataURL:s,toAdjustedBase64:f,toCanvas:d}}function ie(e){return X.blobToDataUri(e).then(function(t){return oe(X.blobToCanvas(e),e,t)})}function ae(e,t){return X.canvasToBlob(e,t).then(function(t){return oe(m.resolve(e),t,e.toDataURL())})}function ce(e){return X.imageToBlob(e).then(function(e){return ie(e)})}var ue=function(e,t){return oe(X.blobToCanvas(e),e,t)},le={fromBlob:ie,fromCanvas:ae,fromImage:ce,fromBlobAndUrlSync:ue};function se(e,t,n){return e=parseFloat(e),e>n?e=n:e<t&&(e=t),e}function fe(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]}var de=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10];function me(e,t){var n,r,o,i,a=[],c=new Array(10);for(n=0;n<5;n++){for(r=0;r<5;r++)a[r]=t[r+5*n];for(r=0;r<5;r++){for(i=0,o=0;o<5;o++)i+=e[r+5*o]*a[o];c[r+5*n]=i}}return c}function ge(e,t){return t=se(t,0,1),e.map(function(e,n){return n%6===0?e=1-(1-e)*t:e*=t,se(e,0,1)})}function pe(e,t){var n;return t=se(t,-1,1),t*=100,t<0?n=127+t/100*127:(n=t%1,n=0===n?de[t]:de[Math.floor(t)]*(1-n)+de[Math.floor(t)+1]*n,n=127*n+127),me(e,[n/127,0,0,0,.5*(127-n),0,n/127,0,0,.5*(127-n),0,0,n/127,0,.5*(127-n),0,0,0,1,0,0,0,0,0,1])}function he(e,t){var n,r,o,i;return t=se(t,-1,1),n=1+(t>0?3*t:t),r=.3086,o=.6094,i=.082,me(e,[r*(1-n)+n,o*(1-n),i*(1-n),0,0,r*(1-n),o*(1-n)+n,i*(1-n),0,0,r*(1-n),o*(1-n),i*(1-n)+n,0,0,0,0,0,1,0,0,0,0,0,1])}function ve(e,t){var n,r,o,i,a;return t=se(t,-180,180)/180*Math.PI,n=Math.cos(t),r=Math.sin(t),o=.213,i=.715,a=.072,me(e,[o+n*(1-o)+r*-o,i+n*-i+r*-i,a+n*-a+r*(1-a),0,0,o+n*-o+.143*r,i+n*(1-i)+.14*r,a+n*-a+-.283*r,0,0,o+n*-o+r*-(1-o),i+n*-i+r*i,a+n*(1-a)+r*a,0,0,0,0,0,1,0,0,0,0,0,1])}function ye(e,t){return t=se(255*t,-255,255),me(e,[1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0,0,0,0,0,1])}function be(e,t,n,r){return t=se(t,0,2),n=se(n,0,2),r=se(r,0,2),me(e,[t,0,0,0,0,0,n,0,0,0,0,0,r,0,0,0,0,0,1,0,0,0,0,0,1])}function we(e,t){return t=se(t,0,1),me(e,ge([.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0,0,0,0,0,1],t))}function xe(e,t){return t=se(t,0,1),me(e,ge([.33,.34,.33,0,0,.33,.34,.33,0,0,.33,.34,.33,0,0,0,0,0,1,0,0,0,0,0,1],t))}var Te={identity:fe,adjust:ge,multiply:me,adjustContrast:pe,adjustBrightness:ye,adjustSaturation:he,adjustHue:ve,adjustColors:be,adjustSepia:we,adjustGrayscale:xe};function ke(e,t){return e.toCanvas().then(function(n){return Ce(n,e.getType(),t)})}function Ce(e,t,n){var r,o=u.get2dContext(e);function i(e,t){var n,r,o,i,a,c=e.data,u=t[0],l=t[1],s=t[2],f=t[3],d=t[4],m=t[5],g=t[6],p=t[7],h=t[8],v=t[9],y=t[10],b=t[11],w=t[12],x=t[13],T=t[14],k=t[15],C=t[16],S=t[17],P=t[18],D=t[19];for(a=0;a<c.length;a+=4)n=c[a],r=c[a+1],o=c[a+2],i=c[a+3],c[a]=n*u+r*l+o*s+i*f+d,c[a+1]=n*m+r*g+o*p+i*h+v,c[a+2]=n*y+r*b+o*w+i*x+T,c[a+3]=n*k+r*C+o*S+i*P+D;return e}return r=i(o.getImageData(0,0,e.width,e.height),n),o.putImageData(r,0,0),le.fromCanvas(e,t)}function Se(e,t){return e.toCanvas().then(function(n){return Pe(n,e.getType(),t)})}function Pe(e,t,n){var r,o,i=u.get2dContext(e);function a(e,t,n){var r,o,i,a,c,u,l,s,f,d,m,g,p,h,v,y,b;function w(e,t,n){return e>n?e=n:e<t&&(e=t),e}for(i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),r=e.data,o=t.data,y=e.width,b=e.height,u=0;u<b;u++)for(c=0;c<y;c++){for(l=s=f=0,m=0;m<i;m++)for(d=0;d<i;d++)g=w(c+d-a,0,y-1),p=w(u+m-a,0,b-1),h=4*(p*y+g),v=n[m*i+d],l+=r[h]*v,s+=r[h+1]*v,f+=r[h+2]*v;h=4*(u*y+c),o[h]=w(l,0,255),o[h+1]=w(s,0,255),o[h+2]=w(f,0,255)}return t}return r=i.getImageData(0,0,e.width,e.height),o=i.getImageData(0,0,e.width,e.height),o=a(r,o,n),i.putImageData(o,0,0),le.fromCanvas(e,t)}function De(e){var t=function(t,n,r){var o,i,a=u.get2dContext(t),c=new Array(256);function l(e,t){var n,r=e.data;for(n=0;n<r.length;n+=4)r[n]=t[r[n]],r[n+1]=t[r[n+1]],r[n+2]=t[r[n+2]];return e}for(i=0;i<c.length;i++)c[i]=e(i,r);return o=l(a.getImageData(0,0,t.width,t.height),c),a.putImageData(o,0,0),le.fromCanvas(t,n)};return function(e,n){return e.toCanvas().then(function(r){return t(r,e.getType(),n)})}}function Ie(e){return function(t,n){return ke(t,e(Te.identity(),n))}}function _e(e){return function(t){return ke(t,e)}}function Ne(e){return function(t){return Se(t,e)}}var Me={invert:_e([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0]),brightness:Ie(Te.adjustBrightness),hue:Ie(Te.adjustHue),saturate:Ie(Te.adjustSaturation),contrast:Ie(Te.adjustContrast),grayscale:Ie(Te.adjustGrayscale),sepia:Ie(Te.adjustSepia),colorize:function(e,t,n,r){return ke(e,Te.adjustColors(Te.identity(),t,n,r))},sharpen:Ne([0,-1,0,-1,5,-1,0,-1,0]),emboss:Ne([-2,-1,0,-1,1,1,0,1,2]),gamma:De(function(e,t){return 255*Math.pow(e/255,1-t)}),exposure:De(function(e,t){return 255*(1-Math.exp(-e/255*t))}),colorFilter:ke,convoluteFilter:Se};function Ee(e,t,n){var r=f.getWidth(e),o=f.getHeight(e),i=t/r,a=n/o,c=!1;(i<.5||i>2)&&(i=i<.5?.5:2,c=!0),(a<.5||a>2)&&(a=a<.5?.5:2,c=!0);var u=Ae(e,i,a);return c?u.then(function(e){return Ee(e,t,n)}):u}function Ae(e,t,n){return new m(function(r){var o=f.getWidth(e),i=f.getHeight(e),a=Math.floor(o*t),c=Math.floor(i*n),l=u.create(a,c),s=u.get2dContext(l);s.drawImage(e,0,0,o,i,0,0,a,c),r(l)})}var Oe={scale:Ee};function Re(e,t){return e.toCanvas().then(function(n){return Fe(n,e.getType(),t)})}function Fe(e,t,n){var r=u.create(e.width,e.height),o=u.get2dContext(r),i=0,a=0;return n=n<0?360+n:n,90!=n&&270!=n||u.resize(r,r.height,r.width),90!=n&&180!=n||(i=r.width),270!=n&&180!=n||(a=r.height),o.translate(i,a),o.rotate(n*Math.PI/180),o.drawImage(e,0,0),le.fromCanvas(r,t)}function Be(e,t){return e.toCanvas().then(function(n){return He(n,e.getType(),t)})}function He(e,t,n){var r=u.create(e.width,e.height),o=u.get2dContext(r);return"v"==n?(o.scale(1,-1),o.drawImage(e,0,-r.height)):(o.scale(-1,1),o.drawImage(e,-r.width,0)),le.fromCanvas(r,t)}function Le(e,t,n,r,o){return e.toCanvas().then(function(i){return Ue(i,e.getType(),t,n,r,o)})}function Ue(e,t,n,r,o,i){var a=u.create(o,i),c=u.get2dContext(a);return c.drawImage(e,-n,-r),le.fromCanvas(a,t)}function je(e,t,n){return e.toCanvas().then(function(r){return Oe.scale(r,t,n).then(function(t){return le.fromCanvas(t,e.getType())})})}var ze={rotate:Re,flip:Be,crop:Le,resize:je},We=function(){function e(e){this.littleEndian=!1,this._dv=new DataView(e)}return e.prototype.readByteAt=function(e){return this._dv.getUint8(e)},e.prototype.read=function(e,t){if(e+t>this.length())return null;for(var n=this.littleEndian?0:-8*(t-1),r=0,o=0;r<t;r++)o|=this.readByteAt(e+r)<<Math.abs(n+8*r);return o},e.prototype.BYTE=function(e){return this.read(e,1)},e.prototype.SHORT=function(e){return this.read(e,2)},e.prototype.LONG=function(e){return this.read(e,4)},e.prototype.SLONG=function(e){var t=this.read(e,4);return t>2147483647?t-4294967296:t},e.prototype.CHAR=function(e){return String.fromCharCode(this.read(e,1))},e.prototype.STRING=function(e,t){return this.asArray("CHAR",e,t).join("")},e.prototype.SEGMENT=function(e,t){var n=this._dv.buffer;switch(arguments.length){case 2:return n.slice(e,e+t);case 1:return n.slice(e);default:return n}},e.prototype.asArray=function(e,t,n){for(var r=[],o=0;o<n;o++)r[o]=this[e](t+o);return r},e.prototype.length=function(){return this._dv?this._dv.byteLength:0},e}(),Ve={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"},thumb:{513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength"}},Ge={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},$e=function(){function e(e){this._offsets={tiffHeader:10,IFD0:null,IFD1:null,exifIFD:null,gpsIFD:null},this._tiffTags={};var t=this;if(t._reader=new We(e),t._idx=t._offsets.tiffHeader,65505!==t.SHORT(0)||"EXIF\0"!==t.STRING(4,5).toUpperCase())throw new Error("Exif data cannot be read or not available.");if(t._reader.littleEndian=18761==t.SHORT(t._idx),42!==t.SHORT(t._idx+=2))throw new Error("Invalid Exif data.");t._offsets.IFD0=t._offsets.tiffHeader+t.LONG(t._idx+=2),t._tiffTags=t.extractTags(t._offsets.IFD0,Ve.tiff),"ExifIFDPointer"in t._tiffTags&&(t._offsets.exifIFD=t._offsets.tiffHeader+t._tiffTags.ExifIFDPointer,delete t._tiffTags.ExifIFDPointer),"GPSInfoIFDPointer"in t._tiffTags&&(t._offsets.gpsIFD=t._offsets.tiffHeader+t._tiffTags.GPSInfoIFDPointer,delete t._tiffTags.GPSInfoIFDPointer);var n=t.LONG(t._offsets.IFD0+12*t.SHORT(t._offsets.IFD0)+2);n&&(t._offsets.IFD1=t._offsets.tiffHeader+n)}return e.prototype.BYTE=function(e){return this._reader.BYTE(e)},e.prototype.SHORT=function(e){return this._reader.SHORT(e)},e.prototype.LONG=function(e){return this._reader.LONG(e)},e.prototype.SLONG=function(e){return this._reader.SLONG(e)},e.prototype.CHAR=function(e){return this._reader.CHAR(e)},e.prototype.STRING=function(e,t){return this._reader.STRING(e,t)},e.prototype.SEGMENT=function(e,t){return this._reader.SEGMENT(e,t)},e.prototype.asArray=function(e,t,n){for(var r=[],o=0;o<n;o++)r[o]=this[e](t+o);return r},e.prototype.length=function(){return this._reader.length()},e.prototype.UNDEFINED=function(){return this.BYTE.apply(this,arguments)},e.prototype.RATIONAL=function(e){return this.LONG(e)/this.LONG(e+4)},e.prototype.SRATIONAL=function(e){return this.SLONG(e)/this.SLONG(e+4)},e.prototype.ASCII=function(e){return this.CHAR(e)},e.prototype.TIFF=function(){return this._tiffTags},e.prototype.EXIF=function(){var e=this,t=null;if(e._offsets.exifIFD){try{t=e.extractTags(e._offsets.exifIFD,Ve.exif)}catch(o){return null}if(t.ExifVersion&&Array.isArray(t.ExifVersion)){for(var n=0,r="";n<t.ExifVersion.length;n++)r+=String.fromCharCode(t.ExifVersion[n]);t.ExifVersion=r}}return t},e.prototype.GPS=function(){var e=this,t=null;if(e._offsets.gpsIFD){try{t=e.extractTags(e._offsets.gpsIFD,Ve.gps)}catch(n){return null}t.GPSVersionID&&Array.isArray(t.GPSVersionID)&&(t.GPSVersionID=t.GPSVersionID.join("."))}return t},e.prototype.thumb=function(){var e=this;if(e._offsets.IFD1)try{var t=e.extractTags(e._offsets.IFD1,Ve.thumb);if("JPEGInterchangeFormat"in t)return e.SEGMENT(e._offsets.tiffHeader+t.JPEGInterchangeFormat,t.JPEGInterchangeFormatLength)}catch(n){}return null},e.prototype.extractTags=function(e,t){var n,r,o,i,a,c,u,l,s=this,f=[],d={},m={1:"BYTE",7:"UNDEFINED",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",9:"SLONG",10:"SRATIONAL"},g={BYTE:1,UNDEFINED:1,ASCII:1,SHORT:2,LONG:4,RATIONAL:8,SLONG:4,SRATIONAL:8};for(n=s.SHORT(e),r=0;r<n;r++)if(f=[],u=e+2+12*r,o=t[s.SHORT(u)],void 0!==o){if(i=m[s.SHORT(u+=2)],a=s.LONG(u+=2),c=g[i],!c)throw new Error("Invalid Exif data.");if(u+=4,c*a>4&&(u=s.LONG(u)+s._offsets.tiffHeader),u+c*a>=s.length())throw new Error("Invalid Exif data.");"ASCII"!==i?(f=s.asArray(i,u,a),l=1==a?f[0]:f,Ge.hasOwnProperty(o)&&"object"!=typeof l?d[o]=Ge[o][l]:d[o]=l):d[o]=s.STRING(u,a).replace(/\0$/,"").trim()}return d},e}(),qe=function(e){return X.blobToArrayBuffer(e).then(function(t){try{var n=new We(t);if(65496===n.SHORT(0)){var r=Ye(n),o=r.filter(function(e){return"APP1"===e.name}),i={};if(!o.length)return m.reject("Headers did not include required information");var a=new $e(o[0].segment);return i={tiff:a.TIFF(),exif:a.EXIF(),gps:a.GPS(),thumb:a.thumb()},i.rawHeaders=r,i}return m.reject("Image was not a jpeg")}catch(c){return m.reject("Unsupported format or not an image: "+e.type+" (Exception: "+c.message+")")}})},Ye=function(e){var t,n,r=[],o=0;t=2;while(t<=e.length())if(n=e.SHORT(t),n>=65488&&n<=65495)t+=2;else{if(65498===n||65497===n)break;o=e.SHORT(t+2)+2,n>=65505&&n<=65519&&r.push({hex:n,name:"APP"+(15&n),start:t,length:o,segment:e.SEGMENT(t,o)}),t+=o}return r},Je={extractFrom:qe},Xe=function(e){return Me.invert(e)},Ke=function(e){return Me.sharpen(e)},Ze=function(e){return Me.emboss(e)},Qe=function(e,t){return Me.gamma(e,t)},et=function(e,t){return Me.exposure(e,t)},tt=function(e,t,n,r){return Me.colorize(e,t,n,r)},nt=function(e,t){return Me.brightness(e,t)},rt=function(e,t){return Me.hue(e,t)},ot=function(e,t){return Me.saturate(e,t)},it=function(e,t){return Me.contrast(e,t)},at=function(e,t){return Me.grayscale(e,t)},ct=function(e,t){return Me.sepia(e,t)},ut=function(e,t){return ze.flip(e,t)},lt=function(e,t,n,r,o){return ze.crop(e,t,n,r,o)},st=function(e,t,n){return ze.resize(e,t,n)},ft=function(e,t){return ze.rotate(e,t)},dt=function(e){var t=6,n=3,r=8,o=function(o){var i=o.tiff.Orientation;switch(i){case t:return ft(e,90);case n:return ft(e,180);case r:return ft(e,270);default:return e}},i=function(){return e};return e.toBlob().then(Je.extractFrom).then(o,i)},mt={invert:Xe,sharpen:Ke,emboss:Ze,brightness:nt,hue:rt,saturate:ot,contrast:it,grayscale:at,sepia:ct,colorize:tt,gamma:Qe,exposure:et,flip:ut,crop:lt,resize:st,rotate:ft,exifRotate:dt},gt=function(e){return le.fromBlob(e)},pt=function(e,t){return le.fromBlobAndUrlSync(e,t)},ht=function(e){return le.fromImage(e)},vt=function(e,t,n){return void 0===t&&void 0===n?yt(e):e.toAdjustedBlob(t,n)},yt=function(e){return e.toBlob()},bt=function(e){return e.toDataURL()},wt={blobToImageResult:gt,fromBlobAndUrlSync:pt,imageToImageResult:ht,imageResultToBlob:vt,imageResultToOriginalBlob:yt,imageResultToDataURL:bt},xt=function(){return N.getOrDie("URL")},Tt=function(e){return xt().createObjectURL(e)},kt=function(e){xt().revokeObjectURL(e)},Ct={createObjectURL:Tt,revokeObjectURL:kt},St=tinymce.util.Tools.resolve("tinymce.util.Delay"),Pt=tinymce.util.Tools.resolve("tinymce.util.Promise"),Dt=tinymce.util.Tools.resolve("tinymce.util.URI"),It=function(e){return e.getParam("imagetools_toolbar","rotateleft rotateright | flipv fliph | crop editimage imageoptions")},_t=function(e){return e.getParam("imagetools_proxy")},Nt=function(e){return e.getParam("imagetools_cors_hosts",[],"string[]")},Mt=function(e){return e.getParam("imagetools_credentials_hosts",[],"string[]")},Et=function(e){return e.getParam("api_key",e.getParam("imagetools_api_key","","string"),"string")},At=function(e){return e.getParam("images_upload_timeout",3e4,"number")},Ot=function(e){return e.getParam("images_reuse_filename",!1,"boolean")},Rt=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Ft=tinymce.util.Tools.resolve("tinymce.ui.Factory");function Bt(){var e=[],t=-1;function n(n){var r;return r=e.splice(++t),e.push(n),{state:n,removed:r}}function r(){if(i())return e[--t]}function o(){if(a())return e[++t]}function i(){return t>0}function a(){return-1!==t&&t<e.length-1}return{data:e,add:n,undo:r,redo:o,canUndo:i,canRedo:a}}var Ht=tinymce.util.Tools.resolve("tinymce.geom.Rect"),Lt=function(e){return new Pt(function(t){var n=function(){e.removeEventListener("load",n),t(e)};e.complete?t(e):e.addEventListener("load",n)})},Ut={loadImage:Lt},jt=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),zt=tinymce.util.Tools.resolve("tinymce.util.Observable"),Wt=tinymce.util.Tools.resolve("tinymce.util.VK"),Vt=0;function Gt(e,t,r,o,i){var a,c,u,l,s="mce-",f=s+"crid-"+Vt++;function d(e,t){return{x:t.x+e.x,y:t.y+e.y,w:t.w,h:t.h}}function m(e,t){return{x:t.x-e.x,y:t.y-e.y,w:t.w,h:t.h}}function g(){return m(r,e)}function p(t,n,o,i){var c,u,l,s,f;c=n.x,u=n.y,l=n.w,s=n.h,c+=o*t.deltaX,u+=i*t.deltaY,l+=o*t.deltaW,s+=i*t.deltaH,l<20&&(l=20),s<20&&(s=20),f=e=Ht.clamp({x:c,y:u,w:l,h:s},r,"move"===t.name),f=m(r,f),a.fire("updateRect",{rect:f}),x(f)}function h(){function t(t){var n,r=Ft.get("DragHelper");return new r(f,{document:o.ownerDocument,handle:f+"-"+t.name,start:function(){n=e},drag:function(e){p(t,n,e.deltaX,e.deltaY)}})}jt('<div id="'+f+'" class="'+s+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(o),n.each(l,function(e){jt("#"+f,o).append('<div id="'+f+"-"+e+'"class="'+s+'croprect-block" style="display: none" data-mce-bogus="all">')}),n.each(c,function(e){jt("#"+f,o).append('<div id="'+f+"-"+e.name+'" class="'+s+"croprect-handle "+s+"croprect-handle-"+e.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+e.label+'" aria-grabbed="false">')}),u=n.map(c,t),y(e),jt(o).on("focusin focusout",function(e){jt(e.target).attr("aria-grabbed","focus"===e.type)}),jt(o).on("keydown",function(t){var r;function o(e,t,n,o,i){e.stopPropagation(),e.preventDefault(),p(r,n,o,i)}switch(n.each(c,function(e){if(t.target.id===f+"-"+e.name)return r=e,!1}),t.keyCode){case Wt.LEFT:o(t,r,e,-10,0);break;case Wt.RIGHT:o(t,r,e,10,0);break;case Wt.UP:o(t,r,e,0,-10);break;case Wt.DOWN:o(t,r,e,0,10);break;case Wt.ENTER:case Wt.SPACEBAR:t.preventDefault(),i();break}})}function v(e){var t;t=n.map(c,function(e){return"#"+f+"-"+e.name}).concat(n.map(l,function(e){return"#"+f+"-"+e})).join(","),e?jt(t,o).show():jt(t,o).hide()}function y(e){function r(e,t){t.h<0&&(t.h=0),t.w<0&&(t.w=0),jt("#"+f+"-"+e,o).css({left:t.x,top:t.y,width:t.w,height:t.h})}n.each(c,function(t){jt("#"+f+"-"+t.name,o).css({left:e.w*t.xMul+e.x,top:e.h*t.yMul+e.y})}),r("top",{x:t.x,y:t.y,w:t.w,h:e.y-t.y}),r("right",{x:e.x+e.w,y:e.y,w:t.w-e.x-e.w+t.x,h:e.h}),r("bottom",{x:t.x,y:e.y+e.h,w:t.w,h:t.h-e.y-e.h+t.y}),r("left",{x:t.x,y:e.y,w:e.x-t.x,h:e.h}),r("move",e)}function b(t){e=t,y(e)}function w(n){t=n,y(e)}function x(e){b(d(r,e))}function T(t){r=t,y(e)}function k(){n.each(u,function(e){e.destroy()}),u=[]}return c=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],l=["top","right","bottom","left"],h(),a=n.extend({toggleVisibility:v,setClampRect:T,setRect:b,getInnerRect:g,setInnerRect:x,setViewPortRect:w,destroy:k},zt),a}var $t=function(e){var t=Ft.get("Control"),n=t.extend({Defaults:{classes:"imagepanel"},selection:function(e){return arguments.length?(this.state.set("rect",e),this):this.state.get("rect")},imageSize:function(){var e=this.state.get("viewRect");return{w:e.w,h:e.h}},toggleCropRect:function(e){this.state.set("cropEnabled",e)},imageSrc:function(e){var t=this,n=new Image;n.src=e,Ut.loadImage(n).then(function(){var e,r,o=t.state.get("viewRect");if(r=t.$el.find("img"),r[0])r.replaceWith(n);else{var i=document.createElement("div");i.className="mce-imagepanel-bg",t.getEl().appendChild(i),t.getEl().appendChild(n)}e={x:0,y:0,w:n.naturalWidth,h:n.naturalHeight},t.state.set("viewRect",e),t.state.set("rect",Ht.inflate(e,-20,-20)),o&&o.w===e.w&&o.h===e.h||t.zoomFit(),t.repaintImage(),t.fire("load")})},zoom:function(e){return arguments.length?(this.state.set("zoom",e),this):this.state.get("zoom")},postRender:function(){return this.imageSrc(this.settings.imageSrc),this._super()},zoomFit:function(){var e,t,n,r,o,i,a,c=this;a=10,e=c.$el.find("img"),t=c.getEl().clientWidth,n=c.getEl().clientHeight,r=e[0].naturalWidth,o=e[0].naturalHeight,i=Math.min((t-a)/r,(n-a)/o),i>=1&&(i=1),c.zoom(i)},repaintImage:function(){var e,t,n,r,o,i,a,c,u,l,s;s=this.getEl(),u=this.zoom(),l=this.state.get("rect"),a=this.$el.find("img"),c=this.$el.find(".mce-imagepanel-bg"),o=s.offsetWidth,i=s.offsetHeight,n=a[0].naturalWidth*u,r=a[0].naturalHeight*u,e=Math.max(0,o/2-n/2),t=Math.max(0,i/2-r/2),a.css({left:e,top:t,width:n,height:r}),c.css({left:e,top:t,width:n,height:r}),this.cropRect&&(this.cropRect.setRect({x:l.x*u+e,y:l.y*u+t,w:l.w*u,h:l.h*u}),this.cropRect.setClampRect({x:e,y:t,w:n,h:r}),this.cropRect.setViewPortRect({x:0,y:0,w:o,h:i}))},bindStates:function(){var e=this;function t(t){e.cropRect=Gt(t,e.state.get("viewRect"),e.state.get("viewRect"),e.getEl(),function(){e.fire("crop")}),e.cropRect.on("updateRect",function(t){var n=t.rect,r=e.zoom();n={x:Math.round(n.x/r),y:Math.round(n.y/r),w:Math.round(n.w/r),h:Math.round(n.h/r)},e.state.set("rect",n)}),e.on("remove",e.cropRect.destroy)}e.state.on("change:cropEnabled",function(t){e.cropRect.toggleVisibility(t.value),e.repaintImage()}),e.state.on("change:zoom",function(){e.repaintImage()}),e.state.on("change:rect",function(n){var r=n.value;e.cropRect||t(r),e.cropRect.setRect(r)})}});return new n(e)},qt={create:$t};function Yt(e){return{blob:e,url:Ct.createObjectURL(e)}}function Jt(e){e&&Ct.revokeObjectURL(e.url)}function Xt(e){n.each(e,Jt)}function Kt(e,t,r,o){var i,a,c,u,l,s,f,d,m,g,p,h,v,y,b,w,x,T,k,C,S,P,D,I,_,N,M,E=Bt(),A=function(t){return e.rtl?t.reverse():t};function O(e){var t,n,r,o;t=i.find("#w")[0],n=i.find("#h")[0],r=parseInt(t.value(),10),o=parseInt(n.value(),10),i.find("#constrain")[0].checked()&&I&&_&&r&&o&&("w"===e.control.settings.name?(o=Math.round(r*N),n.value(o)):(r=Math.round(o*M),t.value(r))),I=r,_=o}function R(e){return Math.round(100*e)+"%"}function F(){i.find("#undo").disabled(!E.canUndo()),i.find("#redo").disabled(!E.canRedo()),i.statusbar.find("#save").disabled(!E.canUndo())}function B(){i.find("#undo").disabled(!0),i.find("#redo").disabled(!0)}function H(e){e&&d.imageSrc(e.url)}function L(e){return function(){var t=n.grep(D,function(t){return t.settings.name!==e});n.each(t,function(e){e.hide()}),e.show(),e.focus()}}function U(e){u=Yt(e),H(u)}function j(e){t=Yt(e),H(t),Xt(E.add(t).removed),F()}function z(){var e=d.selection();wt.blobToImageResult(t.blob).then(function(t){mt.crop(t,e.x,e.y,e.w,e.h).then(ee).then(function(e){j(e),G()})})}var W=function(e){var n=[].slice.call(arguments,1);return function(){var r=u||t;wt.blobToImageResult(r.blob).then(function(t){e.apply(this,[t].concat(n)).then(ee).then(U)})}};function V(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=[].slice.call(arguments,1);return function(){wt.blobToImageResult(t.blob).then(function(t){e.apply(this,[t].concat(o)).then(ee).then(j)})}}function G(){H(t),Jt(u),L(a)(),F()}function $(t,n){u?n():setTimeout(function(){t-- >0?$(t,n):e.windowManager.alert("Error: failed to apply image operation.")},10)}function q(){u?(j(u.blob),G()):$(100,q)}function Y(){var e=d.zoom();e<2&&(e+=.1),d.zoom(e)}function J(){var e=d.zoom();e>.1&&(e-=.1),d.zoom(e)}function X(){t=E.undo(),H(t),F()}function K(){t=E.redo(),H(t),F()}function Z(){r(t.blob),i.close()}function Q(e){return Ft.create("Form",{layout:"flex",direction:"row",labelGap:5,border:"0 0 1 0",align:"center",pack:"center",padding:"0 10 0 10",spacing:5,flex:0,minHeight:60,defaults:{classes:"imagetool",type:"button"},items:e})}var ee=function(e){return e.toBlob()};function te(e,n){return Q(A([{text:"Back",onclick:G},{type:"spacer",flex:1},{text:"Apply",subtype:"primary",onclick:q}])).hide().on("show",function(){B(),wt.blobToImageResult(t.blob).then(function(e){return n(e)}).then(ee).then(function(e){var t=Yt(e);H(t),Jt(u),u=t})})}function ne(n,r,o,i,a){function c(e){wt.blobToImageResult(t.blob).then(function(t){return r(t,e)}).then(ee).then(function(e){var t=Yt(e);H(t),Jt(u),u=t})}return Q(A([{text:"Back",onclick:G},{type:"spacer",flex:1},{type:"slider",flex:1,ondragend:function(e){c(e.value)},minValue:e.rtl?a:i,maxValue:e.rtl?i:a,value:o,previewFilter:R},{type:"spacer",flex:1},{text:"Apply",subtype:"primary",onclick:q}])).hide().on("show",function(){this.find("slider").value(o),B()})}function re(n,r){function o(){var e,n,o;e=i.find("#r")[0].value(),n=i.find("#g")[0].value(),o=i.find("#b")[0].value(),wt.blobToImageResult(t.blob).then(function(t){return r(t,e,n,o)}).then(ee).then(function(e){var t=Yt(e);H(t),Jt(u),u=t})}var a=e.rtl?2:0,c=e.rtl?0:2;return Q(A([{text:"Back",onclick:G},{type:"spacer",flex:1},{type:"slider",label:"R",name:"r",minValue:a,value:1,maxValue:c,ondragend:o,previewFilter:R},{type:"slider",label:"G",name:"g",minValue:a,value:1,maxValue:c,ondragend:o,previewFilter:R},{type:"slider",label:"B",name:"b",minValue:a,value:1,maxValue:c,ondragend:o,previewFilter:R},{type:"spacer",flex:1},{text:"Apply",subtype:"primary",onclick:q}])).hide().on("show",function(){i.find("#r,#g,#b").value(1),B()})}function oe(e){!0===e.control.value()&&(N=_/I,M=I/_)}l=Q(A([{text:"Back",onclick:G},{type:"spacer",flex:1},{text:"Apply",subtype:"primary",onclick:z}])).hide().on("show hide",function(e){d.toggleCropRect("show"===e.type)}).on("show",B),s=Q(A([{text:"Back",onclick:G},{type:"spacer",flex:1},{type:"textbox",name:"w",label:"Width",size:4,onkeyup:O},{type:"textbox",name:"h",label:"Height",size:4,onkeyup:O},{type:"checkbox",name:"constrain",text:"Constrain proportions",checked:!0,onchange:oe},{type:"spacer",flex:1},{text:"Apply",subtype:"primary",onclick:"submit"}])).hide().on("submit",function(e){var t=parseInt(i.find("#w").value(),10),n=parseInt(i.find("#h").value(),10);e.preventDefault(),V(mt.resize,t,n)(),G()}).on("show",B),f=Q(A([{text:"Back",onclick:G},{type:"spacer",flex:1},{icon:"fliph",tooltip:"Flip horizontally",onclick:W(mt.flip,"h")},{icon:"flipv",tooltip:"Flip vertically",onclick:W(mt.flip,"v")},{icon:"rotateleft",tooltip:"Rotate counterclockwise",onclick:W(mt.rotate,-90)},{icon:"rotateright",tooltip:"Rotate clockwise",onclick:W(mt.rotate,90)},{type:"spacer",flex:1},{text:"Apply",subtype:"primary",onclick:q}])).hide().on("show",B),p=te("Invert",mt.invert),k=te("Sharpen",mt.sharpen),C=te("Emboss",mt.emboss),h=ne("Brightness",mt.brightness,0,-1,1),v=ne("Hue",mt.hue,180,0,360),y=ne("Saturate",mt.saturate,0,-1,1),b=ne("Contrast",mt.contrast,0,-1,1),w=ne("Grayscale",mt.grayscale,0,0,1),x=ne("Sepia",mt.sepia,0,0,1),T=re("Colorize",mt.colorize),S=ne("Gamma",mt.gamma,0,-1,1),P=ne("Exposure",mt.exposure,1,0,2),c=Q(A([{text:"Back",onclick:G},{type:"spacer",flex:1},{text:"hue",icon:"hue",onclick:L(v)},{text:"saturate",icon:"saturate",onclick:L(y)},{text:"sepia",icon:"sepia",onclick:L(x)},{text:"emboss",icon:"emboss",onclick:L(C)},{text:"exposure",icon:"exposure",onclick:L(P)},{type:"spacer",flex:1}])).hide(),a=Q(A([{tooltip:"Crop",icon:"crop",onclick:L(l)},{tooltip:"Resize",icon:"resize2",onclick:L(s)},{tooltip:"Orientation",icon:"orientation",onclick:L(f)},{tooltip:"Brightness",icon:"sun",onclick:L(h)},{tooltip:"Sharpen",icon:"sharpen",onclick:L(k)},{tooltip:"Contrast",icon:"contrast",onclick:L(b)},{tooltip:"Color levels",icon:"drop",onclick:L(T)},{tooltip:"Gamma",icon:"gamma",onclick:L(S)},{tooltip:"Invert",icon:"invert",onclick:L(p)}])),d=qt.create({flex:1,imageSrc:t.url}),m=Ft.create("Container",{layout:"flex",direction:"column",pack:"start",border:"0 1 0 0",padding:5,spacing:5,items:[{type:"button",icon:"undo",tooltip:"Undo",name:"undo",onclick:X},{type:"button",icon:"redo",tooltip:"Redo",name:"redo",onclick:K},{type:"button",icon:"zoomin",tooltip:"Zoom in",onclick:Y},{type:"button",icon:"zoomout",tooltip:"Zoom out",onclick:J}]}),g=Ft.create("Container",{type:"container",layout:"flex",direction:"row",align:"stretch",flex:1,items:A([m,d])}),D=[a,l,s,f,c,p,h,v,y,b,w,x,T,k,C,S,P],i=e.windowManager.open({layout:"flex",direction:"column",align:"stretch",minWidth:Math.min(Rt.DOM.getViewPort().w,800),minHeight:Math.min(Rt.DOM.getViewPort().h,650),title:"Edit image",items:D.concat([g]),buttons:A([{text:"Save",name:"save",subtype:"primary",onclick:Z},{text:"Cancel",onclick:"close"}])}),i.on("close",function(){o(),Xt(E.data),E=null,u=null}),E.add(t),F(),d.on("load",function(){I=d.imageSize().w,_=d.imageSize().h,N=_/I,M=I/_,i.find("#w").value(I),i.find("#h").value(_)}),d.on("crop",z)}function Zt(e,t){return new Pt(function(n,r){return t.toBlob().then(function(t){Kt(e,Yt(t),n,r)})})}var Qt={edit:Zt};function en(e){var t,n;function r(e){return/^[0-9\.]+px$/.test(e)}return t=e.style.width,n=e.style.height,t||n?r(t)&&r(n)?{w:parseInt(t,10),h:parseInt(n,10)}:null:(t=e.width,n=e.height,t&&n?{w:parseInt(t,10),h:parseInt(n,10)}:null)}function tn(e,t){var n,r;t&&(n=e.style.width,r=e.style.height,(n||r)&&(e.style.width=t.w+"px",e.style.height=t.h+"px",e.removeAttribute("data-mce-style")),n=e.width,r=e.height,(n||r)&&(e.setAttribute("width",t.w),e.setAttribute("height",t.h)))}function nn(e){return{w:e.naturalWidth,h:e.naturalHeight}}var rn={getImageSize:en,setImageSize:tn,getNaturalImageSize:nn},on=function(e){if(null===e)return"null";var t=typeof e;return"object"===t&&Array.prototype.isPrototypeOf(e)?"array":"object"===t&&String.prototype.isPrototypeOf(e)?"string":t},an=function(e){return function(t){return on(t)===e}},cn=an("function"),un=function(e,t){for(var n=0,r=e.length;n<r;n++){var o=e[n];if(t(o,n,e))return C.some(o)}return C.none()},ln=Array.prototype.slice;cn(Array.from)&&Array.from;function sn(){var e=N.getOrDie("XMLHttpRequest");return new e}var fn=function(e){return null!==e&&void 0!==e},dn=function(e,t){var n;return n=t.reduce(function(e,t){return fn(e)?e[t]:void 0},e),fn(n)?n:null},mn=function(e,t,r){return new Pt(function(o){var i;i=sn(),i.onreadystatechange=function(){4===i.readyState&&o({status:i.status,blob:this.response})},i.open("GET",e,!0),i.withCredentials=r,n.each(t,function(e,t){i.setRequestHeader(t,e)}),i.responseType="blob",i.send()})},gn=function(e){return new Pt(function(t){var n=E();n.onload=function(e){var n=e.target;t(n.result)},n.readAsText(e)})},pn=function(e){var t;try{t=JSON.parse(e)}catch(n){}return t},hn={traverse:dn,readBlob:gn,requestUrlAsBlob:mn,parseJson:pn},vn=[{code:404,message:"Could not find Image Proxy"},{code:403,message:"Rejected request"},{code:0,message:"Incorrect Image Proxy URL"}],yn=[{type:"key_missing",message:"The request did not include an api key."},{type:"key_not_found",message:"The provided api key could not be found."},{type:"domain_not_trusted",message:"The api key is not valid for the request origins."}],bn=function(e){return 400===e||403===e||500===e},wn=function(e){var t=un(vn,function(t){return e===t.code}).fold(g("Unknown ImageProxy error"),function(e){return e.message});return"ImageProxy HTTP error: "+t},xn=function(e){var t=wn(e);return Pt.reject(t)},Tn=function(e){return un(yn,function(t){return t.type===e}).fold(g("Unknown service error"),function(e){return e.message})},kn=function(e){var t=hn.parseJson(e),n=hn.traverse(t,["error","type"]),r=n?Tn(n):"Invalid JSON in service error message";return"ImageProxy Service error: "+r},Cn=function(e,t){return hn.readBlob(t).then(function(e){var t=kn(e);return Pt.reject(t)})},Sn=function(e,t){return bn(e)?Cn(e,t):xn(e)},Pn={handleServiceErrorResponse:Sn,handleHttpError:xn,getHttpErrorMsg:wn,getServiceErrorMsg:Tn},Dn=function(e,t){var n=-1===e.indexOf("?")?"?":"&";return/[?&]apiKey=/.test(e)||!t?e:e+n+"apiKey="+encodeURIComponent(t)},In=function(e,t){var n={"Content-Type":"application/json;charset=UTF-8","tiny-api-key":t};return hn.requestUrlAsBlob(Dn(e,t),n,!1).then(function(e){return e.status<200||e.status>=300?Pn.handleServiceErrorResponse(e.status,e.blob):Pt.resolve(e.blob)})};function _n(e,t){return hn.requestUrlAsBlob(e,{},t).then(function(e){return e.status<200||e.status>=300?Pn.handleHttpError(e.status):Pt.resolve(e.blob)})}var Nn=function(e,t,n){return t?In(e,t):_n(e,n)},Mn={getUrl:Nn},En=0,An=function(e,t){var n=e.dom.is(t,"img:not([data-mce-object],[data-mce-placeholder])");return n&&(Hn(e,t)||Ln(e,t)||e.settings.imagetools_proxy)},On=function(e,t){e.notificationManager.open({text:t,type:"error"})},Rn=function(e){return e.selection.getNode()},Fn=function(e,t){var n=t.match(/\/([^\/\?]+)?\.(?:jpeg|jpg|png|gif)(?:\?|$)/i);return n?e.dom.encode(n[1]):null},Bn=function(){return"imagetools"+En++},Hn=function(e,t){var n=t.src;return 0===n.indexOf("data:")||0===n.indexOf("blob:")||new Dt(n).host===e.documentBaseURI.host},Ln=function(e,t){return-1!==n.inArray(Nt(e),new Dt(t.src).host)},Un=function(e,t){return-1!==n.inArray(Mt(e),new Dt(t.src).host)},jn=function(e,t){var n,r=t.src;return Ln(e,t)?Mn.getUrl(t.src,null,Un(e,t)):Hn(e,t)?re.imageToBlob(t):(r=_t(e),r+=(-1===r.indexOf("?")?"?":"&")+"url="+encodeURIComponent(t.src),n=Et(e),Mn.getUrl(r,n,!1))},zn=function(e){var t;return t=e.editorUpload.blobCache.getByUri(Rn(e).src),t?Pt.resolve(t.blob()):jn(e,Rn(e))},Wn=function(e,t){var n=St.setEditorTimeout(e,function(){e.editorUpload.uploadImagesAuto()},At(e));t.set(n)},Vn=function(e){clearTimeout(e.get())},Gn=function(e,t,n,r,o){return t.toBlob().then(function(i){var a,c,u,l,s;return u=e.editorUpload.blobCache,s=Rn(e),a=s.src,Ot(e)&&(l=u.getByUri(a),l?(a=l.uri(),c=l.name()):c=Fn(e,a)),l=u.create({id:Bn(),blob:i,base64:t.toBase64(),uri:a,name:c}),u.add(l),e.undoManager.transact(function(){function t(){e.$(s).off("load",t),e.nodeChanged(),n?e.editorUpload.uploadImagesAuto():(Vn(r),Wn(e,r))}e.$(s).on("load",t),o&&e.$(s).attr({width:o.w,height:o.h}),e.$(s).attr({src:l.blobUri()}).removeAttr("data-mce-src")}),l})},$n=function(e,t,n,r){return function(){return e._scanForImages().then(p(zn,e)).then(wt.blobToImageResult).then(n).then(function(n){return Gn(e,n,!1,t,r)},function(t){On(e,t)})}},qn=function(e,t,n){return function(){var r=rn.getImageSize(Rn(e)),o=r?{w:r.h,h:r.w}:null;return $n(e,t,function(e){return mt.rotate(e,n)},o)()}},Yn=function(e,t,n){return function(){return $n(e,t,function(e){return mt.flip(e,n)})()}},Jn=function(e,t){return function(){var n=Rn(e),r=rn.getNaturalImageSize(n),o=function(e){return new Pt(function(t){re.blobToImage(e).then(function(o){var i=rn.getNaturalImageSize(o);r.w===i.w&&r.h===i.h||rn.getImageSize(n)&&rn.setImageSize(n,i),Ct.revokeObjectURL(o.src),t(e)})})},i=function(e,n){return Qt.edit(e,n).then(o).then(wt.blobToImageResult).then(function(n){return Gn(e,n,!0,t)},function(){})};zn(e).then(wt.blobToImageResult).then(p(i,e),function(t){On(e,t)})}},Xn={rotate:qn,flip:Yn,editImageDialog:Jn,isEditableImage:An,cancelTimedUpload:Vn},Kn=function(e,t){n.each({mceImageRotateLeft:Xn.rotate(e,t,-90),mceImageRotateRight:Xn.rotate(e,t,90),mceImageFlipVertical:Xn.flip(e,t,"v"),mceImageFlipHorizontal:Xn.flip(e,t,"h"),mceEditImage:Xn.editImageDialog(e,t)},function(t,n){e.addCommand(n,t)})},Zn={register:Kn},Qn=function(e,t,n){e.on("NodeChange",function(r){var o=n.get();o&&o.src!==r.element.src&&(Xn.cancelTimedUpload(t),e.editorUpload.uploadImagesAuto(),n.set(null)),Xn.isEditableImage(e,r.element)&&n.set(r.element)})},er={setup:Qn},tr=function(e){e.addButton("rotateleft",{title:"Rotate counterclockwise",cmd:"mceImageRotateLeft"}),e.addButton("rotateright",{title:"Rotate clockwise",cmd:"mceImageRotateRight"}),e.addButton("flipv",{title:"Flip vertically",cmd:"mceImageFlipVertical"}),e.addButton("fliph",{title:"Flip horizontally",cmd:"mceImageFlipHorizontal"}),e.addButton("editimage",{title:"Edit image",cmd:"mceEditImage"}),e.addButton("imageoptions",{title:"Image options",icon:"options",cmd:"mceImage"})},nr={register:tr},rr=function(e){e.addContextToolbar(p(Xn.isEditableImage,e),It(e))},or={register:rr};function ir(){}t.add("imagetools",function(t){var n=e(0),r=e(null);Zn.register(t,n),nr.register(t),or.register(t),er.setup(t,n,r)})})()})()},a376:function(e,t){(function(){(function(){"use strict";var e=function(t){var n=t,r=function(){return n},o=function(e){n=e},i=function(){return e(r())};return{get:r,set:o,clone:i}},t=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=function(e){return e.getParam("insertdatetime_dateformat",e.translate("%Y-%m-%d"))},r=function(e){return e.getParam("insertdatetime_timeformat",e.translate("%H:%M:%S"))},o=function(e){return e.getParam("insertdatetime_formats",["%H:%M:%S","%Y-%m-%d","%I:%M:%S %p","%D"])},i=function(e){var t=o(e);return t.length>0?t[0]:r(e)},a=function(e){return e.getParam("insertdatetime_element",!1)},c={getDateFormat:n,getTimeFormat:r,getFormats:o,getDefaultDateTime:i,shouldInsertTimeElement:a},u="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),l="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),s="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),f="January February March April May June July August September October November December".split(" "),d=function(e,t){if(e=""+e,e.length<t)for(var n=0;n<t-e.length;n++)e="0"+e;return e},m=function(e,t,n){return n=n||new Date,t=t.replace("%D","%m/%d/%Y"),t=t.replace("%r","%I:%M:%S %p"),t=t.replace("%Y",""+n.getFullYear()),t=t.replace("%y",""+n.getYear()),t=t.replace("%m",d(n.getMonth()+1,2)),t=t.replace("%d",d(n.getDate(),2)),t=t.replace("%H",""+d(n.getHours(),2)),t=t.replace("%M",""+d(n.getMinutes(),2)),t=t.replace("%S",""+d(n.getSeconds(),2)),t=t.replace("%I",""+((n.getHours()+11)%12+1)),t=t.replace("%p",n.getHours()<12?"AM":"PM"),t=t.replace("%B",""+e.translate(f[n.getMonth()])),t=t.replace("%b",""+e.translate(s[n.getMonth()])),t=t.replace("%A",""+e.translate(l[n.getDay()])),t=t.replace("%a",""+e.translate(u[n.getDay()])),t=t.replace("%%","%"),t},g=function(e,t,n,r){var o=e.dom.create("time",{datetime:n},r);t.parentNode.insertBefore(o,t),e.dom.remove(t),e.selection.select(o,!0),e.selection.collapse(!1)},p=function(e,t){if(c.shouldInsertTimeElement(e)){var n=m(e,t),r=void 0;r=/%[HMSIp]/.test(t)?m(e,"%Y-%m-%dT%H:%M"):m(e,"%Y-%m-%d");var o=e.dom.getParent(e.selection.getStart(),"time");o?g(e,o,r,n):e.insertContent('<time datetime="'+r+'">'+n+"</time>")}else e.insertContent(m(e,t))},h={insertDateTime:p,getDateTime:m},v=function(e){e.addCommand("mceInsertDate",function(){h.insertDateTime(e,c.getDateFormat(e))}),e.addCommand("mceInsertTime",function(){h.insertDateTime(e,c.getTimeFormat(e))})},y={register:v},b=tinymce.util.Tools.resolve("tinymce.util.Tools"),w=function(e,t){var n=c.getFormats(e);return b.map(n,function(n){return{text:h.getDateTime(e,n),onclick:function(){t.set(n),h.insertDateTime(e,n)}}})},x=function(e,t){var n=w(e,t);e.addButton("insertdatetime",{type:"splitbutton",title:"Insert date/time",menu:n,onclick:function(){var n=t.get();h.insertDateTime(e,n||c.getDefaultDateTime(e))}}),e.addMenuItem("insertdatetime",{icon:"date",text:"Date/time",menu:n,context:"insert"})},T={register:x};function k(){}t.add("insertdatetime",function(t){var n=e(null);y.register(t),T.register(t,n)})})()})()},bc54:function(e,t,n){n("7c4f")},c361:function(e,t){(function(){(function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=function(e,t){for(var n="",r=0;r<t;r++)n+=e;return n},n=function(e){return!!e.plugins.visualchars&&e.plugins.visualchars.isEnabled()},r=function(e,r){var o=n(e)?'<span class="mce-nbsp">&nbsp;</span>':"&nbsp;";e.insertContent(t(o,r)),e.dom.setAttrib(e.dom.select("span.mce-nbsp"),"data-mce-bogus","1")},o={insertNbsp:r},i=function(e){e.addCommand("mceNonBreaking",function(){o.insertNbsp(e,1)})},a={register:i},c=tinymce.util.Tools.resolve("tinymce.util.VK"),u=function(e){var t=e.getParam("nonbreaking_force_tab",0);return"boolean"===typeof t?!0===t?3:0:t},l={getKeyboardSpaces:u},s=function(e){var t=l.getKeyboardSpaces(e);t>0&&e.on("keydown",function(n){if(n.keyCode===c.TAB&&!n.isDefaultPrevented()){if(n.shiftKey)return;n.preventDefault(),n.stopImmediatePropagation(),o.insertNbsp(e,t)}})},f={setup:s},d=function(e){e.addButton("nonbreaking",{title:"Nonbreaking space",cmd:"mceNonBreaking"}),e.addMenuItem("nonbreaking",{icon:"nonbreaking",text:"Nonbreaking space",cmd:"mceNonBreaking",context:"insert"})},m={register:d};function g(){}e.add("nonbreaking",function(e){a.register(e),m.register(e),f.setup(e)})})()})()},c3d7:function(e,t,n){n("16f1")},cf08:function(e,t){(function(){(function(){"use strict";var e=function(t){var n=t,r=function(){return n},o=function(e){n=e},i=function(){return e(r())};return{get:r,set:o,clone:i}},t=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=function(e){var t=function(){return e.get()};return{isEnabled:t}},r={get:n},o=function(e,t){return e.fire("VisualChars",{state:t})},i={fireVisualChars:o},a={" ":"nbsp","­":"shy"},c=function(e,t){var n,r="";for(n in e)r+=n;return new RegExp("["+r+"]",t?"g":"")},u=function(e){var t,n="";for(t in e)n&&(n+=","),n+="span.mce-"+e[t];return n},l={charMap:a,regExp:c(a),regExpGlobal:c(a,!0),selector:u(a),charMapToRegExp:c,charMapToSelector:u},s=function(e){return function(){return e}},f=s(!1),d=s(!0),m=f,g=d,p=function(){return h},h=function(){var e=function(e){return e.isNone()},t=function(e){return e()},n=function(e){return e},r=function(){},o=function(){return null},i=function(){},a={fold:function(e,t){return e()},is:m,isSome:m,isNone:g,getOr:n,getOrThunk:t,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:o,getOrUndefined:i,or:n,orThunk:t,map:p,ap:p,each:r,bind:p,flatten:p,exists:m,forall:g,filter:p,equals:e,equals_:e,toArray:function(){return[]},toString:s("none()")};return Object.freeze&&Object.freeze(a),a}(),v=function(e){var t=function(){return e},n=function(){return i},r=function(t){return v(t(e))},o=function(t){return t(e)},i={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:g,isNone:m,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:r,ap:function(t){return t.fold(p,function(t){return v(t(e))})},each:function(t){t(e)},bind:o,flatten:t,exists:o,forall:o,filter:function(t){return t(e)?i:h},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(m,function(t){return n(e,t)})},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return i},y=function(e){return null===e||void 0===e?h:v(e)},b={some:v,none:p,from:y},w=function(e){if(null===e)return"null";var t=typeof e;return"object"===t&&Array.prototype.isPrototypeOf(e)?"array":"object"===t&&String.prototype.isPrototypeOf(e)?"string":t},x=function(e){return function(t){return w(t)===e}},T=x("function"),k=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o,e)}return r},C=function(e,t){for(var n=0,r=e.length;n<r;n++){var o=e[n];t(o,n,e)}},S=Array.prototype.slice,P=(T(Array.from)&&Array.from,function(e,t){var n=t||document,r=n.createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||r.childNodes.length>1)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return _(r.childNodes[0])}),D=function(e,t){var n=t||document,r=n.createElement(e);return _(r)},I=function(e,t){var n=t||document,r=n.createTextNode(e);return _(r)},_=function(e){if(null===e||void 0===e)throw new Error("Node cannot be null or undefined");return{dom:s(e)}},N=function(e,t,n){var r=e.dom();return b.from(r.elementFromPoint(t,n)).map(_)},M={fromHtml:P,fromTag:D,fromText:I,fromDom:_,fromPoint:N},E=(Node.ATTRIBUTE_NODE,Node.CDATA_SECTION_NODE,Node.COMMENT_NODE,Node.DOCUMENT_NODE,Node.DOCUMENT_TYPE_NODE,Node.DOCUMENT_FRAGMENT_NODE,Node.ELEMENT_NODE,Node.TEXT_NODE),A=(Node.PROCESSING_INSTRUCTION_NODE,Node.ENTITY_REFERENCE_NODE,Node.ENTITY_NODE,Node.NOTATION_NODE,function(e){return e.dom().nodeType}),O=function(e){return e.dom().nodeValue},R=function(e){return function(t){return A(t)===e}},F=R(E),B=function(e){return'<span data-mce-bogus="1" class="mce-'+l.charMap[e]+'">'+e+"</span>"},H={wrapCharWithSpan:B},L=function(e){return F(e)&&void 0!==O(e)&&l.regExp.test(O(e))},U=function(e,t){var n=[],r=e.dom(),o=k(r.childNodes,M.fromDom);return C(o,function(e){t(e)&&(n=n.concat([e])),n=n.concat(U(e,t))}),n},j=function(e,t){while(e.parentNode){if(e.parentNode===t)return e;e=e.parentNode}},z=function(e){return e.replace(l.regExpGlobal,H.wrapCharWithSpan)},W={isMatch:L,filterDescendants:U,findParentElm:j,replaceWithSpans:z},V=function(e,t){var n,r,o=W.filterDescendants(M.fromDom(t),W.isMatch);C(o,function(t){var o=W.replaceWithSpans(O(t));r=e.dom.create("div",null,o);while(n=r.lastChild)e.dom.insertAfter(n,t.dom());e.dom.remove(t.dom())})},G=function(e,t){var n=e.dom.select(l.selector,t);C(n,function(t){e.dom.remove(t,1)})},$=function(e){var t=e.getBody(),n=e.selection.getBookmark(),r=W.findParentElm(e.selection.getNode(),t);r=void 0!==r?r:t,G(e,r),V(e,r),e.selection.moveToBookmark(n)},q={show:V,hide:G,toggle:$},Y=function(e,t){var n,r=e.getBody(),o=e.selection;t.set(!t.get()),i.fireVisualChars(e,t.get()),n=o.getBookmark(),!0===t.get()?q.show(e,r):q.hide(e,r),o.moveToBookmark(n)},J={toggleVisualChars:Y},X=function(e,t){e.addCommand("mceVisualChars",function(){J.toggleVisualChars(e,t)})},K={register:X},Z=tinymce.util.Tools.resolve("tinymce.util.Delay"),Q=function(e,t){var n=Z.debounce(function(){q.toggle(e)},300);!1!==e.settings.forced_root_block&&e.on("keydown",function(r){!0===t.get()&&(13===r.keyCode?q.toggle(e):n())})},ee={setup:Q},te=function(e){return e.getParam("visualchars_default_state",!1)},ne={isEnabledByDefault:te},re=function(e,t){e.on("init",function(){var n=!ne.isEnabledByDefault(e);t.set(n),J.toggleVisualChars(e,t)})},oe={setup:re},ie=function(e){return function(t){var n=t.control;e.on("VisualChars",function(e){n.active(e.state)})}},ae=function(e){e.addButton("visualchars",{active:!1,title:"Show invisible characters",cmd:"mceVisualChars",onPostRender:ie(e)}),e.addMenuItem("visualchars",{text:"Show invisible characters",cmd:"mceVisualChars",onPostRender:ie(e),selectable:!0,context:"view",prependToContext:!0})};function ce(){}t.add("visualchars",function(t){var n=e(!1);return K.register(t,n),ae(t),ee.setup(t,n),oe.setup(t,n),r.get(n)})})()})()},d169:function(e,t){(function(){(function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.util.Tools"),n=[["cool","cry","embarassed","foot-in-mouth"],["frown","innocent","kiss","laughing"],["money-mouth","sealed","smile","surprised"],["tongue-out","undecided","wink","yell"]],r=function(e){var r;return r='<table role="list" class="mce-grid">',t.each(n,function(n){r+="<tr>",t.each(n,function(t){var n=e+"/img/smiley-"+t+".gif";r+='<td><a href="#" data-mce-url="'+n+'" data-mce-alt="'+t+'" tabindex="-1" role="option" aria-label="'+t+'"><img src="'+n+'" style="width: 18px; height: 18px" role="presentation" /></a></td>'}),r+="</tr>"}),r+="</table>",r},o={getHtml:r},i=function(e,t,n){e.insertContent(e.dom.createHTML("img",{src:t,alt:n}))},a=function(e,t){var n=o.getHtml(t);e.addButton("emoticons",{type:"panelbutton",panel:{role:"application",autohide:!0,html:n,onclick:function(t){var n=e.dom.getParent(t.target,"a");n&&(i(e,n.getAttribute("data-mce-url"),n.getAttribute("data-mce-alt")),this.hide())}},tooltip:"Emoticons"})},c={register:a};function u(){}e.add("emoticons",function(e,t){c.register(e,t)})})()})()},d2dc:function(e,t,n){n("169f")},d4c3:function(e,t){(function(){(function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=function(e){e.addCommand("mcePrint",function(){e.getWin().print()})},n={register:t},r=function(e){e.addButton("print",{title:"Print",cmd:"mcePrint"}),e.addMenuItem("print",{text:"Print",cmd:"mcePrint",icon:"print"})},o={register:r};function i(){}e.add("print",function(e){n.register(e),o.register(e),e.addShortcut("Meta+P","","mcePrint")})})()})()},dbbc:function(e,t){(function(){(function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=function(e){e.addCommand("InsertHorizontalRule",function(){e.execCommand("mceInsertContent",!1,"<hr />")})},n={register:t},r=function(e){e.addButton("hr",{icon:"hr",tooltip:"Horizontal line",cmd:"InsertHorizontalRule"}),e.addMenuItem("hr",{icon:"hr",text:"Horizontal line",cmd:"InsertHorizontalRule",context:"insert"})},o={register:r};function i(){}e.add("hr",function(e){n.register(e),o.register(e)})})()})()},dcb7:function(e,t,n){n("e704")},e2d6:function(e,t){(function(){(function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.util.Tools"),n=function(e,n){var r,o=e.dom,i=e.selection.getSelectedBlocks();i.length&&(r=o.getAttrib(i[0],"dir"),t.each(i,function(e){o.getParent(e.parentNode,'*[dir="'+n+'"]',o.getRoot())||o.setAttrib(e,"dir",r!==n?n:null)}),e.nodeChanged())},r={setDir:n},o=function(e){e.addCommand("mceDirectionLTR",function(){r.setDir(e,"ltr")}),e.addCommand("mceDirectionRTL",function(){r.setDir(e,"rtl")})},i={register:o},a=function(e){var n=[];return t.each("h1 h2 h3 h4 h5 h6 div p".split(" "),function(t){n.push(t+"[dir="+e+"]")}),n.join(",")},c=function(e){e.addButton("ltr",{title:"Left to right",cmd:"mceDirectionLTR",stateSelector:a("ltr")}),e.addButton("rtl",{title:"Right to left",cmd:"mceDirectionRTL",stateSelector:a("rtl")})},u={register:c};function l(){}e.add("directionality",function(e){i.register(e),u.register(e)})})()})()},e455:function(e,t,n){n("6b68")},e704:function(e,t){(function(){(function(){"use strict";var e=function(t){var n=t,r=function(){return n},o=function(e){n=e},i=function(){return e(r())};return{get:r,set:o,clone:i}},t=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=function(e){return!(!/(^|[ ,])tinymcespellchecker([, ]|$)/.test(e.settings.plugins)||!t.get("tinymcespellchecker"))&&("undefined"!==typeof window.console&&window.console.log&&window.console.log("Spell Checker Pro is incompatible with Spell Checker plugin! Remove 'spellchecker' from the 'plugins' option."),!0)},r={hasProPlugin:n},o=function(e){var t="English=en,Danish=da,Dutch=nl,Finnish=fi,French=fr_FR,German=de,Italian=it,Polish=pl,Portuguese=pt_BR,Spanish=es,Swedish=sv";return e.getParam("spellchecker_languages",t)},i=function(e){var t=e.getParam("language","en");return e.getParam("spellchecker_language",t)},a=function(e){return e.getParam("spellchecker_rpc_url")},c=function(e){return e.getParam("spellchecker_callback")},u=function(e){var t=new RegExp('[^\\s!"#$%&()*+,-./:;<=>?@[\\]^_{|}`§©«®±¶·¸»¼½¾¿×÷¤”“„    ]+',"g");return e.getParam("spellchecker_wordchar_pattern",t)},l={getLanguages:o,getLanguage:i,getRpcUrl:a,getSpellcheckerCallback:c,getSpellcheckerWordcharPattern:u},s=tinymce.util.Tools.resolve("tinymce.util.Tools"),f=tinymce.util.Tools.resolve("tinymce.util.URI"),d=tinymce.util.Tools.resolve("tinymce.util.XHR"),m=function(e){return e.fire("SpellcheckStart")},g=function(e){return e.fire("SpellcheckEnd")},p={fireSpellcheckStart:m,fireSpellcheckEnd:g};function h(e){return e&&1===e.nodeType&&"false"===e.contentEditable}var v,y=function(e,t){var n,r,o,i,a,c=[],u=t.dom;function l(e,t){if(!e[0])throw new Error("findAndReplaceDOMText cannot handle zero-length matches");return{start:e.index,end:e.index+e[0].length,text:e[0],data:t}}function s(e){var t;if(3===e.nodeType)return e.data;if(i[e.nodeName]&&!o[e.nodeName])return"";if(h(e))return"\n";if(t="",(o[e.nodeName]||a[e.nodeName])&&(t+="\n"),e=e.firstChild)do{t+=s(e)}while(e=e.nextSibling);return t}function f(e,t,n){var r,c,u,l,s,f=[],d=0,m=e,g=0;t=t.slice(0),t.sort(function(e,t){return e.start-t.start}),s=t.shift();e:while(1){if((o[m.nodeName]||a[m.nodeName]||h(m))&&d++,3===m.nodeType&&(!c&&m.length+d>=s.end?(c=m,l=s.end-d):r&&f.push(m),!r&&m.length+d>s.start&&(r=m,u=s.start-d),d+=m.length),r&&c){if(m=n({startNode:r,startNodeIndex:u,endNode:c,endNodeIndex:l,innerNodes:f,match:s.text,matchIndex:g}),d-=c.length-l,r=null,c=null,f=[],s=t.shift(),g++,!s)break}else if(i[m.nodeName]&&!o[m.nodeName]||!m.firstChild){if(m.nextSibling){m=m.nextSibling;continue}}else if(!h(m)){m=m.firstChild;continue}while(1){if(m.nextSibling){m=m.nextSibling;break}if(m.parentNode===e)break e;m=m.parentNode}}}function d(e){function t(t,n){var r=c[n];r.stencil||(r.stencil=e(r));var o=r.stencil.cloneNode(!1);return o.setAttribute("data-mce-index",n),t&&o.appendChild(u.doc.createTextNode(t)),o}return function(e){var n,r,o,i=e.startNode,a=e.endNode,c=e.matchIndex,l=u.doc;if(i===a){var s=i;o=s.parentNode,e.startNodeIndex>0&&(n=l.createTextNode(s.data.substring(0,e.startNodeIndex)),o.insertBefore(n,s));var f=t(e.match,c);return o.insertBefore(f,s),e.endNodeIndex<s.length&&(r=l.createTextNode(s.data.substring(e.endNodeIndex)),o.insertBefore(r,s)),s.parentNode.removeChild(s),f}n=l.createTextNode(i.data.substring(0,e.startNodeIndex)),r=l.createTextNode(a.data.substring(e.endNodeIndex));for(var d=t(i.data.substring(e.startNodeIndex),c),m=0,g=e.innerNodes.length;m<g;++m){var p=e.innerNodes[m],h=t(p.data,c);p.parentNode.replaceChild(h,p)}var v=t(a.data.substring(0,e.endNodeIndex),c);return o=i.parentNode,o.insertBefore(n,i),o.insertBefore(d,i),o.removeChild(i),o=a.parentNode,o.insertBefore(v,a),o.insertBefore(r,a),o.removeChild(a),v}}function m(e){var t=e.parentNode;t.insertBefore(e.firstChild,e),e.parentNode.removeChild(e)}function g(e){return-1!==e.className.indexOf("mce-spellchecker-word")}function p(t){var n=e.getElementsByTagName("*"),r=[];t="number"===typeof t?""+t:null;for(var o=0;o<n.length;o++){var i=n[o],a=i.getAttribute("data-mce-index");null!==a&&a.length&&g(i)&&(a!==t&&null!==t||r.push(i))}return r}function v(e){var t=c.length;while(t--)if(c[t]===e)return t;return-1}function y(e){var t=[];return b(function(n,r){e(n,r)&&t.push(n)}),c=t,this}function b(e){for(var t=0,n=c.length;t<n;t++)if(!1===e(c[t],t))break;return this}function w(t){return c.length&&f(e,c,d(t)),this}function x(e,t){if(r&&e.global)while(n=e.exec(r))c.push(l(n,t));return this}function T(e){var t,n=p(e?v(e):null);t=n.length;while(t--)m(n[t]);return this}function k(e){return c[e.getAttribute("data-mce-index")]}function C(e){return p(v(e))[0]}function S(e,t,n){return c.push({start:e,end:e+t,text:r.substr(e,t),data:n}),this}function P(e){var n=p(v(e)),r=t.dom.createRng();return r.setStartBefore(n[0]),r.setEndAfter(n[n.length-1]),r}function D(e,n){var r=P(e);return r.deleteContents(),n.length>0&&r.insertNode(t.dom.doc.createTextNode(n)),r}function I(){return c.splice(0,c.length),T(),this}return o=t.schema.getBlockElements(),i=t.schema.getWhiteSpaceElements(),a=t.schema.getShortEndedElements(),r=s(e),{text:r,matches:c,each:b,filter:y,reset:I,matchFromElement:k,elementFromMatch:C,find:x,add:S,wrap:w,unwrap:T,replace:D,rangeFromMatch:P,indexOf:v}},b=function(e,t){if(!t.get()){var n=y(e.getBody(),e);t.set(n)}return t.get()},w=function(e){for(var t in e)return!1;return!0},x=function(e,t,n){return function(r,o,i,a){var c={method:r,lang:n.get()},u="";c["addToDictionary"===r?"word":"text"]=o,s.each(c,function(e,t){u&&(u+="&"),u+=t+"="+encodeURIComponent(e)}),d.send({url:new f(t).toAbsolute(l.getRpcUrl(e)),type:"post",content_type:"application/x-www-form-urlencoded",data:u,success:function(t){if(t=JSON.parse(t),t)t.error?a(t.error):i(t);else{var n=e.translate("Server response wasn't proper JSON.");a(n)}},error:function(){var t=e.translate("The spelling service was not found: (")+l.getRpcUrl(e)+e.translate(")");a(t)}})}},T=function(e,t,n,r,o,i,a){var c=l.getSpellcheckerCallback(e),u=c||x(e,t,n);u.call(e.plugins.spellchecker,r,o,i,a)},k=function(e,t,n,r,o,i){if(!D(e,n,r)){var a=function(t){e.notificationManager.open({text:t,type:"error"}),e.setProgressState(!1),D(e,n,r)},c=function(t){N(e,n,r,o,t)};e.setProgressState(!0),T(e,t,i,"spellcheck",b(e,r).text,c,a),e.focus()}},C=function(e,t,n){e.dom.select("span.mce-spellchecker-word").length||D(e,t,n)},S=function(e,t,n,r,o,i,a){e.setProgressState(!0),T(e,t,o,"addToDictionary",i,function(){e.setProgressState(!1),e.dom.remove(a,!0),C(e,n,r)},function(t){e.notificationManager.open({text:t,type:"error"}),e.setProgressState(!1)})},P=function(e,t,n,r,o,i){e.selection.collapse(),i?s.each(e.dom.select("span.mce-spellchecker-word"),function(t){t.getAttribute("data-mce-word")===r&&e.dom.remove(t,!0)}):e.dom.remove(o,!0),C(e,t,n)},D=function(e,t,n){var r=e.selection.getBookmark();if(b(e,n).reset(),e.selection.moveToBookmark(r),n.set(null),t.get())return t.set(!1),p.fireSpellcheckEnd(e),!0},I=function(e){var t=e.getAttribute("data-mce-index");return"number"===typeof t?""+t:t},_=function(e,t){var n,r=[];if(n=s.toArray(e.getBody().getElementsByTagName("span")),n.length)for(var o=0;o<n.length;o++){var i=I(n[o]);null!==i&&i.length&&(i===t.toString()&&r.push(n[o]))}return r},N=function(e,t,n,r,o){var i,a;if("string"!==typeof o&&o.words?(a=!!o.dictionary,i=o.words):i=o,e.setProgressState(!1),w(i)){var c=e.translate("No misspellings found.");return e.notificationManager.open({text:c,type:"info"}),void t.set(!1)}r.set({suggestions:i,hasDictionarySupport:a});var u=e.selection.getBookmark();b(e,n).find(l.getSpellcheckerWordcharPattern(e)).filter(function(e){return!!i[e.text]}).wrap(function(t){return e.dom.create("span",{class:"mce-spellchecker-word","data-mce-bogus":1,"data-mce-word":t.text})}),e.selection.moveToBookmark(u),t.set(!0),p.fireSpellcheckStart(e)},M={spellcheck:k,checkIfFinished:C,addToDictionary:S,ignoreWord:P,findSpansByIndex:_,getElmIndex:I,markErrors:N},E=function(e,t,n,r,o,i){var a=function(){return o.get()},c=function(){return l.getSpellcheckerWordcharPattern(e)},u=function(o){M.markErrors(e,t,r,n,o)},s=function(){return r.get()};return{getTextMatcher:s,getWordCharPattern:c,markErrors:u,getLanguage:a}},A={get:E},O=function(e,t,n,r,o,i){e.addCommand("mceSpellCheck",function(){M.spellcheck(e,t,n,r,o,i)})},R={register:O},F=function(e,t){var n=[];return s.each(t,function(e){n.push({selectable:!0,text:e.name,data:e.value})}),n},B=function(e,t){return function(e){var n=t.get();e.control.items().each(function(e){e.active(e.settings.data===n)})}},H=function(e){return s.map(l.getLanguages(e).split(","),function(e){return e=e.split("="),{name:e[0],value:e[1]}})},L=function(e,t,n,r,o,i){var a=F("Language",H(e)),c=function(){M.spellcheck(e,t,n,r,i,o)},u={tooltip:"Spellcheck",onclick:c,onPostRender:function(t){var r=t.control;e.on("SpellcheckStart SpellcheckEnd",function(){r.active(n.get())})}};a.length>1&&(u.type="splitbutton",u.menu=a,u.onshow=B(e,o),u.onselect=function(e){o.set(e.control.settings.data)}),e.addButton("spellchecker",u),e.addMenuItem("spellchecker",{text:"Spellcheck",context:"tools",onclick:c,selectable:!0,onPostRender:function(){var t=this;t.active(n.get()),e.on("SpellcheckStart SpellcheckEnd",function(){t.active(n.get())})}})},U={register:L},j=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),z=tinymce.util.Tools.resolve("tinymce.ui.Factory"),W=function(e,t,n,r,o,i,a,c){var u=[],l=n.get().suggestions[a];s.each(l,function(t){u.push({text:t,onclick:function(){e.insertContent(e.dom.encode(t)),e.dom.remove(c),M.checkIfFinished(e,r,o)}})}),u.push({text:"-"});var f=n.get().hasDictionarySupport;f&&u.push({text:"Add to Dictionary",onclick:function(){M.addToDictionary(e,t,r,o,i,a,c)}}),u.push.apply(u,[{text:"Ignore",onclick:function(){M.ignoreWord(e,r,o,a,c)}},{text:"Ignore all",onclick:function(){M.ignoreWord(e,r,o,a,c,!0)}}]),v=z.create("menu",{items:u,context:"contextmenu",onautohide:function(e){-1!==e.target.className.indexOf("spellchecker")&&e.preventDefault()},onhide:function(){v.remove(),v=null}}),v.renderTo(document.body);var d=j.DOM.getPos(e.getContentAreaContainer()),m=e.dom.getPos(c[0]),g=e.dom.getRoot();"BODY"===g.nodeName?(m.x-=g.ownerDocument.documentElement.scrollLeft||g.scrollLeft,m.y-=g.ownerDocument.documentElement.scrollTop||g.scrollTop):(m.x-=g.scrollLeft,m.y-=g.scrollTop),d.x+=m.x,d.y+=m.y,v.moveTo(d.x,d.y+c[0].offsetHeight)},V=function(e,t,n,r,o,i){e.on("click",function(a){var c=a.target;if("mce-spellchecker-word"===c.className){a.preventDefault();var u=M.findSpansByIndex(e,M.getElmIndex(c));if(u.length>0){var l=e.dom.createRng();l.setStartBefore(u[0]),l.setEndAfter(u[u.length-1]),e.selection.setRng(l),W(e,t,n,r,o,i,c.getAttribute("data-mce-word"),u)}}})},G={setup:V};function $(){}t.add("spellchecker",function(t,n){if(!1===r.hasProPlugin(t)){var o=e(!1),i=e(l.getLanguage(t)),a=e(null),c=e(null);return U.register(t,n,o,a,i,c),G.setup(t,n,c,o,a,i),R.register(t,n,o,a,c,i),A.get(t,o,c,a,i,n)}})})()})()},ebac:function(e,t,n){n("080b")},eda9:function(e,t,n){n("c361")},ef37:function(e,t,n){n("fd06")},f034:function(e,t){(function(){(function(){"use strict";var e=function(t){var n=t,r=function(){return n},o=function(e){n=e},i=function(){return e(r())};return{get:r,set:o,clone:i}},t=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=function(e){return{isFullscreen:function(){return null!==e.get()}}},r={get:n},o=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),i=function(e,t){e.fire("FullscreenStateChanged",{state:t})},a={fireFullscreenStateChanged:i},c=o.DOM,u=function(){var e,t,n=window,r=document,o=r.body;return o.offsetWidth&&(e=o.offsetWidth,t=o.offsetHeight),n.innerWidth&&n.innerHeight&&(e=n.innerWidth,t=n.innerHeight),{w:e,h:t}},l=function(){var e=c.getViewPort();return{x:e.x,y:e.y}},s=function(e){window.scrollTo(e.x,e.y)},f=function(e,t){var n,r,o,i,f=document.body,d=document.documentElement,m=t.get(),g=function(){c.setStyle(o,"height",u().h-(r.clientHeight-o.clientHeight))},p=function(){c.unbind(window,"resize",g)};if(r=e.getContainer(),n=r.style,o=e.getContentAreaContainer().firstChild,i=o.style,m)i.width=m.iframeWidth,i.height=m.iframeHeight,m.containerWidth&&(n.width=m.containerWidth),m.containerHeight&&(n.height=m.containerHeight),c.removeClass(f,"mce-fullscreen"),c.removeClass(d,"mce-fullscreen"),c.removeClass(r,"mce-fullscreen"),s(m.scrollPos),c.unbind(window,"resize",m.resizeHandler),e.off("remove",m.removeHandler),t.set(null),a.fireFullscreenStateChanged(e,!1);else{var h={scrollPos:l(),containerWidth:n.width,containerHeight:n.height,iframeWidth:i.width,iframeHeight:i.height,resizeHandler:g,removeHandler:p};i.width=i.height="100%",n.width=n.height="",c.addClass(f,"mce-fullscreen"),c.addClass(d,"mce-fullscreen"),c.addClass(r,"mce-fullscreen"),c.bind(window,"resize",g),e.on("remove",p),g(),t.set(h),a.fireFullscreenStateChanged(e,!0)}},d={toggleFullscreen:f},m=function(e,t){e.addCommand("mceFullScreen",function(){d.toggleFullscreen(e,t)})},g={register:m},p=function(e){return function(t){var n=t.control;e.on("FullscreenStateChanged",function(e){n.active(e.state)})}},h=function(e){e.addMenuItem("fullscreen",{text:"Fullscreen",shortcut:"Ctrl+Shift+F",selectable:!0,cmd:"mceFullScreen",onPostRender:p(e),context:"view"}),e.addButton("fullscreen",{active:!1,tooltip:"Fullscreen",cmd:"mceFullScreen",onPostRender:p(e)})},v={register:h};function y(){}t.add("fullscreen",function(t){var n=e(null);return t.settings.inline?r.get(n):(g.register(t,n),v.register(t),t.addShortcut("Ctrl+Shift+F","","mceFullScreen"),r.get(n))})})()})()},fd06:function(e,t){(function(){(function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),n=tinymce.util.Tools.resolve("tinymce.util.I18n"),r=tinymce.util.Tools.resolve("tinymce.util.Tools"),o=function(e){return e.getParam("toc_class","mce-toc")},i=function(e){var t=e.getParam("toc_header","h2");return/^h[1-6]$/.test(t)?t:"h2"},a=function(e){var t=parseInt(e.getParam("toc_depth","3"),10);return t>=1&&t<=9?t:3},c={getTocClass:o,getTocHeader:i,getTocDepth:a},u=function(e){var t=0;return function(){var n=(new Date).getTime().toString(32);return e+n+(t++).toString(32)}},l={create:u},s=l.create("mcetoc_"),f=function(e){var t,n=[];for(t=1;t<=e;t++)n.push("h"+t);return n.join(",")},d=function(e){return m(e).length>0},m=function(e){var t=c.getTocClass(e),n=c.getTocHeader(e),o=f(c.getTocDepth(e)),i=e.$(o);return i.length&&/^h[1-9]$/i.test(n)&&(i=i.filter(function(n,r){return!e.dom.hasClass(r.parentNode,t)})),r.map(i,function(t){return{id:t.id?t.id:s(),level:parseInt(t.nodeName.replace(/^H/i,""),10),title:e.$.text(t),element:t}})},g=function(e){var t,n=9;for(t=0;t<e.length;t++)if(e[t].level<n&&(n=e[t].level),1===n)return n;return n},p=function(e,n){var r="<"+e+' contenteditable="true">',o="</"+e+">";return r+t.DOM.encode(n)+o},h=function(e){var t=v(e);return'<div class="'+e.dom.encode(c.getTocClass(e))+'" contenteditable="false">'+t+"</div>"},v=function(e){var t,r,o,i,a="",u=m(e),l=g(u)-1;if(!u.length)return"";for(a+=p(c.getTocHeader(e),n.translate("Table of Contents")),t=0;t<u.length;t++){if(o=u[t],o.element.id=o.id,i=u[t+1]&&u[t+1].level,l===o.level)a+="<li>";else for(r=l;r<o.level;r++)a+="<ul><li>";if(a+='<a href="#'+o.id+'">'+o.title+"</a>",i!==o.level&&i)for(r=o.level;r>i;r--)a+="</li></ul><li>";else a+="</li>",i||(a+="</ul>");l=o.level}return a},y=function(e,t){return!t.length||e.dom.getParents(t[0],".mce-offscreen-selection").length>0},b=function(e){var t=c.getTocClass(e),n=e.$("."+t);y(e,n)?e.insertContent(h(e)):w(e)},w=function(e){var t=c.getTocClass(e),n=e.$("."+t);n.length&&e.undoManager.transact(function(){n.html(v(e))})},x={hasHeaders:d,insertToc:b,updateToc:w},T=function(e){e.addCommand("mceInsertToc",function(){x.insertToc(e)}),e.addCommand("mceUpdateToc",function(){x.updateToc(e)})},k={register:T},C=function(e){var t=e.$,n=c.getTocClass(e);e.on("PreProcess",function(e){var r=t("."+n,e.node);r.length&&(r.removeAttr("contentEditable"),r.find("[contenteditable]").removeAttr("contentEditable"))}),e.on("SetContent",function(){var e=t("."+n);e.length&&(e.attr("contentEditable",!1),e.children(":first-child").attr("contentEditable",!0))})},S={setup:C},P=function(e){return function(t){var n=t.control;e.on("LoadContent SetContent change",function(){n.disabled(e.readonly||!x.hasHeaders(e))})}},D=function(e){return function(t){return t&&e.dom.is(t,"."+c.getTocClass(e))&&e.getBody().contains(t)}},I=function(e){e.addButton("toc",{tooltip:"Table of Contents",cmd:"mceInsertToc",icon:"toc",onPostRender:P(e)}),e.addButton("tocupdate",{tooltip:"Update",cmd:"mceUpdateToc",icon:"reload"}),e.addMenuItem("toc",{text:"Table of Contents",context:"insert",cmd:"mceInsertToc",onPostRender:P(e)}),e.addContextToolbar(D(e),"tocupdate")},_={register:I};function N(){}e.add("toc",function(e){k.register(e),_.register(e),S.setup(e)})})()})()}}]);